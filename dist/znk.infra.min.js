!function(a){"use strict";a.module("znk.infra",["znk.infra.config","znk.infra.pngSequence","znk.infra.enum","znk.infra.svgIcon","znk.infra.general","znk.infra.scroll","znk.infra.content","znk.infra.znkExercise","znk.infra.storage","znk.infra.utility","znk.infra.exerciseResult","znk.infra.contentAvail","znk.infra.popUp","znk.infra.estimatedScore","znk.infra.stats","znk.infra.hint","znk.infra.znkTimeline","znk.infra.analytics"])}(angular),function(a){"use strict";a.module("znk.infra.analytics",[])}(angular),function(a){"use strict";a.module("znk.infra.content",[])}(angular),function(a){"use strict";a.module("znk.infra.contentAvail",["znk.infra.config"])}(angular),function(a){"use strict";a.module("znk.infra.enum",[])}(angular),function(a){"use strict";a.module("znk.infra.estimatedScore",["znk.infra.config","znk.infra.znkExercise","znk.infra.utility"]).run(["EstimatedScoreEventsHandlerSrv",function(a){a.init()}])}(angular),function(a){"use strict";a.module("znk.infra.exerciseResult",["znk.infra.config","znk.infra.utility"])}(angular),function(a){"use strict";a.module("znk.infra.general",["znk.infra.enum","znk.infra.svgIcon"]).config(["SvgIconSrvProvider",function(a){var b={"clock-icon":"components/general/svg/clock-icon.svg"};a.registerSvgSources(b)}])}(angular),function(a){"use strict";a.module("znk.infra.hint",["znk.infra.config"])}(angular),function(a){"use strict";a.module("znk.infra.config",[])}(angular),function(a){"use strict";a.module("znk.infra.pngSequence",[])}(angular),function(a){"use strict";a.module("znk.infra.popUp",["znk.infra.svgIcon"]).config(["SvgIconSrvProvider",function(a){var b={"exclamation-mark":"components/popUp/svg/exclamation-mark-icon.svg"};a.registerSvgSources(b)}])}(angular),function(a){"use strict";a.module("znk.infra.scroll",[])}(angular),function(a){"use strict";a.module("znk.infra.stats",["znk.infra.enum","znk.infra.znkExercise","znk.infra.utility"]).run(["StatsEventsHandlerSrv",function(a){a.init()}])}(angular),function(a){"use strict";a.module("znk.infra.storage",[])}(angular),function(a){"use strict";a.module("znk.infra.svgIcon",[])}(angular),function(a){"use strict";a.module("znk.infra.utility",[])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise",["znk.infra.enum","znk.infra.svgIcon","znk.infra.scroll","ngAnimate"]).config(["SvgIconSrvProvider",function(a){var b={chevron:"components/znkExercise/svg/chevron-icon.svg",correct:"components/znkExercise/svg/correct-icon.svg",wrong:"components/znkExercise/svg/wrong-icon.svg",info:"components/znkExercise/svg/info-icon.svg",arrow:"components/znkExercise/svg/arrow-icon.svg"};a.registerSvgSources(b)}])}(angular),function(a){"use strict";a.module("znk.infra.znkTimeline",["znk.infra.svgIcon","znk.infra.enum"])}(angular),function(a){"use strict";var b={appOpen:"App Open",appClose:"App Close",signUp:"Sign Up",login:"Login",getStartedClicked:"Get Started Clicked",diagnosticStart:"Diagnostic Start",diagnosticEnd:"Diagnostic End",diagnosticSectionStarted:"Diagnostic Section Started",diagnosticSectionCompleted:"Diagnostic Section Completed",diagnosticsSkipAudioClicked:"Diagnostics Skip Audio Clicked",workoutStarted:"Workout Started",workoutCompleted:"Workout Completed",tutorialViewed:"Tutorial Viewed",tutorialClosed:"Tutorial Closed",flashcardStackViewed:"Flashcard Stack Viewed",flashcardStackCompleted:"Flashcard stack Completed",performanceBannerClicked:"Performance Banner Clicked",performanceClosed:"Performance Closed",tipsAndTricksBannerClicked:"Tips & Tricks Banner Clicked",flashcardsBannerClicked:"Flashcards Banner Clicked",fullTestsBannerClicked:"Full tests Banner Clicked",miniTestsBannerClicked:"Mini Tests Banner Clicked",writtenSolutionClicked:"Written Solution Clicked",writtenSolutionClosed:"Written Solution Closed",sectionStarted:"Section Started",sectionCompleted:"Section Completed",testCompleted:"Test Completed",exception:"Exception",upgradeAppVersion:"Upgrade App Version",firstTimeAppOpen:"First Time App Open",appRatePopupOpened:"App Rate Popup Opened",rateButtonClicked:"Rate Button Clicked",cancelRateButtonClicked:"Cancel Rate Button Clicked",laterRateButtonClicked:"Later Rate Button Clicked",purchaseModalOpened:"Purchase Modal opened",purchaseOrderStarted:"Order Started",purchaseOrderPending:"Order Pending",purchaseOrderCompleted:"Order Completed",purchaseOrderCancelled:"Order Cancelled"};a.module("znk.infra.analytics").provider("znkAnalyticsSrv",function(){var c,d=!1;this.setDebugMode=function(a){d=a},this.extendEventsConst=function(c){a.extend(b,c)},this.setEventsHandler=function(a){c=a},this.$get=["$log","$injector","znkAnalyticsUtilSrv",function(e,f,g){var h={getEventsConst:function(){return b||e.error("znkAnalyticsSrv getEventsConst:  _eventsConst is missing!"),b},getDebugMode:function(){return d}};c||e.error("znkAnalyticsSrv eventsHandler is missing!");var i=f.invoke(c);return g.events["const"]=b,a.forEach(i,function(a,b){var c=g.events.list[b];c?h[b]=c.bind(null,i[b]):e.error("znkAnalyticsSrv key is missing in infra or incorrect! key:",b)}),h}]}).run(["znkAnalyticsSrv","$window",function(a,b){var c=a.getDebugMode();c&&(b.znkAnalyticsEvents=a.getEventsConst())}])}(angular),function(a){"use strict";function b(){var a,b=new Date,c=b.getHours();return a=c>=6&&12>c?"Morning":c>=12&&18>c?"Afternoon":c>=18&&24>c?"Evening":c>=24&&6>c?"Night":b.toString()}function c(a){return a.reduce(function(a,b){return b.userAnswer?b.isAnsweredCorrectly?a.correct++:a.wrong++:a.skip++,a},{correct:0,wrong:0,skip:0})}a.module("znk.infra.analytics").service("znkAnalyticsUtilSrv",["$log",function(d){function e(d){return d.props=d.props||{},d.dayTime&&(d.props.dayTime=b()),d.questionsArr&&(d.props=a.extend({},d.props,c(d.questionsArr))),d.props}function f(a){var b=h.events["const"];if(!b)return void d.error("znkAnalyticsUtilSrv events const not defined!",h.events);var c={};return a.eventName&&(b[a.eventName]?c.eventName=b[a.eventName]:a.nameOnTheFly?c.eventName=a.eventName:d.error("znkAnalyticsUtilSrv eventName not matching any eky in events const key:",a.eventName)),c.props=e(a),c}function g(a,b){var c=f(b);return a(c)}var h=this;this.events={},this.events.list={eventTrack:g,timeTrack:g,pageTrack:g,setUsername:g,setUserProperties:g}}])}(angular),function(a){function b(){var b;this.setContent=function(a){b=a},this.$get=["$q","$injector",function(c,d){function e(){var a;return function(){return{get:function(){return a?c.when(a):f().then(function(b){return a=b,a.updatePublication(function(b){b.key()!==a.key&&(a.latestRevisions=b.val(),a.key=b.key())}),b})},set:function(b,d){return a.revisionManifest[b]=d,c.when({rev:d.rev,status:"update"})}}}}function f(){return g||(g=d.invoke(b)),g}var g,h=e(),i={};return i.getRev=function(b,d){if(!d||!d.revisionManifest||!d.latestRevisions)return c.when({error:"No Data Found! ",data:d});var e,f=d.revisionManifest[b],g=d.latestRevisions[b];return a.isUndefined(g)?c.when({error:"Not Found",data:d}):(e=f?f.rev<g.rev?{rev:f.rev,status:"old"}:f.rev===g.rev?{rev:g.rev,status:"same"}:{error:"failed to get revision!",data:d}:{rev:g.rev,status:"new"},c.when(e))},i.setRev=function(a,b){return h().set(a,{rev:b})},i.getContent=function(a){if(!a||!a.exerciseType)return c.reject({error:"Error: getContent require exerciseType!"});var b=a.exerciseId?a.exerciseType+a.exerciseId:a.exerciseType;return h().get().then(function(a){return i.getRev(b,a).then(function(d){if(d.error)return c.when(d);if(!a.contentRoot)return c.when({error:"Error: getContent require contentRoot to be defined in config phase!"});if(!a.userRoot)return c.when({error:"Error: getContent require userRoot to be defined in config phase!"});var e=a.contentRoot+b+"-rev-"+d.rev,f=a.create(e);return"new"===d.status&&i.setRev(b,d.rev).then(function(){var c=a.userRoot+"/revisionManifest/"+b,e=a.create(c);e.set({rev:d.rev})}),f.get()})})},i.getAllContentIdsByKey=function(a){var b=[];return h().get().then(function(c){for(var d in c.latestRevisions)-1!==d.indexOf(a)&&b.push(d);return b})},i}]}a.module("znk.infra.content").provider("ContentSrv",b)}(angular),function(a){"use strict";a.module("znk.infra.contentAvail").service("ContentAvailSrv",["$q","$parse","InfraConfigSrv",function(b,c,d){function e(){var a=d.getStorageService(),b=a.variables.appUserSpacePath+"/purchase",c={daily:0,exam:{},tutorial:{},subscription:{}};return a.get(b,c)}function f(){var a=d.getStorageService(),b="freeContent",c={daily:0,exam:{},tutorial:{}};return a.get(b,c)}function g(a){return"id_"+a}function h(a){return a&&a.expiryDate&&a.expiryDate>Date.now()}function i(){return b.all([e(),f()]).then(function(a){var b=a[0],c=h(b.subscription);return c?!0:a})}function j(a,b){var c=g(b);return!(a.exam!==l&&!a.exam[c])}function k(a,b){var d=b.join("."),e=c(d);return!!e(a)}var l="all";this.hasSubscription=function(){return e().then(function(a){return h(a.subscription)})},this.isDailyAvail=function(c){return!a.isNumber(c)||isNaN(c)?b.reject("daily order should be a number"):i().then(function(b){if(b===!0)return!0;var d=b[0],e=b[1];if(e.daily>=c)return!0;if(a.isString(d.daily))return d.daily===l;var f=(d.daily||0)+(e.daily||0);return f>=c})},this.isExamAvail=function(a){return i().then(function(b){if(b===!0)return!0;var c=b[0],d=b[1],e=j(c,a);return e?!0:k(d,["exam",g(a)])})},this.isSectionAvail=function(a,b){return i().then(function(c){if(c===!0)return!0;var d=c[0],e=c[1],f=g(a),h=g(b),i=j(d,a);return i?!0:k(e,["exam",f,"sections",h])})},this.isTutorialAvail=function(a){return isNaN(a)?b.reject("ContentAvailSrv: tutorial id should be a number"):i().then(function(b){if(b===!0)return!0;var c=g(a),d=b[0],e=b[1];return e.tutorial[c]?!0:!(d.tutorial!==l&&!d.tutorial[c])})}}])}(angular),function(a){"use strict";a.module("znk.infra.enum").factory("AnswerTypeEnum",["EnumSrv",function(a){return new a.BaseEnum([["SELECT_ANSWER",0,"select answer"],["FREE_TEXT_ANSWER",1,"free text answer"],["RATE_ANSWER",3,"rate answer"]])}])}(angular),function(a){"use strict";a.module("znk.infra.enum").factory("ExamTypeEnum",["EnumSrv",function(a){return new a.BaseEnum([["FULL TEST",0,"test"],["MINI TEST",1,"miniTest"],["DIAGNOSTIC",2,"diagnostic"]])}])}(angular),function(a){"use strict";var b={NEW:0,ACTIVE:1,COMPLETED:2,COMING_SOON:3};a.module("znk.infra.enum").constant("exerciseStatusConst",b),a.module("znk.infra.enum").factory("ExerciseStatusEnum",["EnumSrv",function(a){return new a.BaseEnum([["NEW",b.NEW,"new"],["ACTIVE",b.ACTIVE,"active"],["COMPLETED",b.COMPLETED,"completed"],["COMING_SOON",b.COMING_SOON,"coming soon"]])}])}(angular),function(a){"use strict";a.module("znk.infra.enum").factory("ExerciseTimeEnum",["EnumSrv",function(a){return new a.BaseEnum([["5_MIN",5,"5 min"],["10_MIN",10,"10 min"],["15_MIN",15,"15 min"]])}])}(angular),function(a){"use strict";var b={TUTORIAL:1,PRACTICE:2,GAME:3,SECTION:4,DRILL:5};a.module("znk.infra.enum").constant("exerciseTypeConst",b).factory("ExerciseTypeEnum",["EnumSrv",function(a){return new a.BaseEnum([["TUTORIAL",1,"Tutorial"],["PRACTICE",2,"Practice"],["GAME",3,"Game"],["SECTION",4,"Section"],["DRILL",5,"Drill"]])}])}(angular),function(a){"use strict";a.module("znk.infra.enum").factory("QuestionFormatEnum",["EnumSrv",function(a){var b=new a.BaseEnum([["TEXT",1,"text"],["AUDIO",2,"audio"],["TEXT_AUDIO",3,"text audio"],["PROSE_SUMMARY",4,"prose Summary"],["FILL_IN_TABLE",5,"fill in a table"],["CONNECTING_CONTENT",6,"connecting content"],["INDEPENDENT",7,"independent"],["STANDARD",8,"standard"]]);return b}])}(angular),function(a){"use strict";var b={MATH:0,READING:1,WRITING:2,LISTENING:3,SPEAKING:4,ENGLISH:5,SCIENCE:6,VERBAL:7,ESSAY:8};a.module("znk.infra.enum").constant("SubjectEnumConst",b),a.module("znk.infra.enum").factory("SubjectEnum",["EnumSrv",function(a){var c=new a.BaseEnum([["MATH",b.MATH,"math"],["READING",b.READING,"reading"],["WRITING",b.WRITING,"writing"],["LISTENING",b.LISTENING,"listening"],["SPEAKING",b.SPEAKING,"speaking"],["ENGLISH",b.ENGLISH,"english"],["SCIENCE",b.SCIENCE,"science"],["VERBAL",b.VERBAL,"verbal"],["ESSAY",b.ESSAY,"essay"]]);return c}])}(angular),function(a){a.module("znk.infra.enum").factory("EnumSrv",[function(){function b(a){var b=0,c=1,d=2,e=this;a.forEach(function(a){e[a[b]]={"enum":a[c],val:a[d]}})}var c={};return c.BaseEnum=b,b.prototype.getEnumMap=function(){var a=this,b={},c=Object.keys(a);for(var d in c){var e=c[d],f=a[e];b[f["enum"]]=f.val}return b},b.prototype.getEnumArr=function(){var b=this,c=[];for(var d in b){var e=b[d];a.isObject(e)&&c.push(e)}return c},b.prototype.getValByEnum=function(a){var b,c=this;for(var d in c)if(c.hasOwnProperty(d)){var e=c[d];if(e["enum"]===a){b=e.val;break}}return b},b.prototype.getNameToEnumMap=function(){var a=this,b={},c=Object.keys(a);return c.forEach(function(c){var d=a[c];b[c]=d["enum"]}),b},c.flashcardStatus=new b([["keep",0,"Keep"],["remove",1,"Remove"]]),c}])}(angular),function(a){"use strict";a.module("znk.infra.estimatedScore").provider("EstimatedScoreEventsHandlerSrv",function(){function b(b,c,d,e){var f={};return a.isDefined(b)&&(f.correctWithin=b),a.isDefined(c)&&(f.correctAfter=c),a.isDefined(d)&&(f.wrongWithin=d),a.isDefined(e)&&(f.wrongAfter=e),f.unanswered=0,f}var c={};this.setDiagnosticScoring=function(a){var d=Object.keys(a);d.forEach(function(d){var e=a[d];c[d]=b.apply(this,e)})};var d={};this.setExerciseRawPoints=function(a,c){d[a]=b.apply(this,c)};var e;this.setEventProcessControl=function(a){e=a},this.$get=["$rootScope","ExamTypeEnum","EstimatedScoreSrv","SubjectEnum","ExerciseTypeEnum","ExerciseAnswerStatusEnum","exerciseEventsConst","$log","UtilitySrv","$injector","$q",function(b,f,g,h,i,j,k,l,m,n,o){function p(a,b,c){var d;return b===j.unanswered["enum"]?d="unanswered":(d=b===j.correct["enum"]?"correct":"wrong",d+=c?"Within":"After"),a[d]}function q(a,b){var d=c[a.difficulty],e=b.isAnsweredCorrectly?j.correct["enum"]:j.wrong["enum"];return p(d,e,!0)}function r(b,c){var d=0,e=b.questions,f=m.array.convertToMap(e);c.questionResults.forEach(function(c,e){var g=f[c.questionId];a.isUndefined(g)?l.error("EstimatedScoreEventsHandler: question for result is missing","section id: ",b.id,"result index: ",e):d+=q(g,c)}),g.setDiagnosticSectionScore(d,i.SECTION["enum"],b.subjectId,b.id)}function s(a,b){var c=!b.afterAllowedTime,e=j.convertSimpleAnswerToAnswerStatusEnum(b.isAnsweredCorrectly),f=d[a];return p(f,e,c)}function t(a,b){d[a]||l.error("EstimatedScoreEventsHandlerSrv: raw scoring not exits for the following exercise type: "+a);var c=b.questionResults,e={total:c.length*d[a].correctWithin,earned:0};return c.forEach(function(b){e.earned+=s(a,b)}),e}function u(b,c,d){if(!e)return o.when(!0);var f=n.invoke(e);return a.isFunction(f)&&(f=f(b,c,d)),o.when(f)}function v(a,b,c,d){u(a,c,d).then(function(b){if(b){var e=t(a,d);g.addRawScore(e,a,c.subjectId,c.id)}})}a.equals({},c)&&l.error("EstimatedScoreEventsHandlerSrv: diagnosticScoring was not set !!!"),a.equals({},d)&&l.error("EstimatedScoreEventsHandlerSrv: diagnosticScoring was not set !!!");var w={},x=b.$new(!0);return x.$on(k.section.FINISH,function(a,b,c,d){u(k.section.FINISH,b,c).then(function(a){if(a){var e=d.typeId===f.DIAGNOSTIC["enum"];e&&r(b,c);var h=t(i.SECTION["enum"],c);g.addRawScore(h,i.SECTION["enum"],b.subjectId,b.id,e)}})}),a.forEach(i,function(a,b){if("SECTION"!==b){var c=b.toLowerCase(),d=k[c].FINISH;x.$on(d,v.bind(w,a["enum"]))}}),w.init=a.noop,w}]})}(angular),function(a){"use strict";a.module("znk.infra.estimatedScore").service("EstimatedScoreHelperSrv",["SubjectEnum","InfraConfigSrv",function(b,c){function d(c,d){var e=Object.keys(b);for(var f in e){var g=b[e[f]];c[g["enum"]]=a.copy(d)}}var e=this,f=c.getStorageService(),g=f.variables.appUserSpacePath+"/estimatedScore";e.getEstimatedScoreData=function(){return e.getEstimatedScoreData.prom||(e.getEstimatedScoreData.prom=f.get(g).then(function(b){var c={estimatedScores:{},sectionsRawScores:{},exercisesRawScores:{},processedExercises:[]};d(c.estimatedScores,[]),d(c.sectionsRawScores,[]);var e={total:0,earned:0};return d(c.exercisesRawScores,e),a.forEach(c,function(c,d){if(a.isUndefined(b[d])&&(b[d]=c),b[d]!==c&&a.isObject(c)){var e=b[d];a.forEach(c,function(b,c){a.isUndefined(e[c])&&(e[c]=b)})}}),b})),e.getEstimatedScoreData.prom},e.setEstimateScoreData=function(a){return f.set(g,a)}}])}(angular),function(a){a.module("znk.infra.estimatedScore").provider("EstimatedScoreSrv",function(){var b;this.setSubjectsRawScoreEdges=function(a){b=a};var c;this.setRawScoreToRealScoreFn=function(a){c=a};var d,e;this.setMinMaxDiagnosticScore=function(a,b){d=a,e=b},this.$get=["EstimatedScoreHelperSrv","ExerciseTypeEnum","$injector","$q","SubjectEnum","$log",function(f,g,h,i,j,k){function l(b,c){return p.then(function(){return f.getEstimatedScoreData().then(function(d){return a.isUndefined(c)?d[b]:d[b][c]})})}function m(c,d,e){var f=0,g=0,h=0;c.forEach(function(a,b){h+=a.total;var c=+b+1;f+=a.total*c,g+=a.earned*c});var i={total:h,earned:h*g/f};isNaN(i.earned)&&(i.earned=0);var j=2/3*i.earned+1/3*d.earned,l=2/3*i.total+1/3*d.total,m=b[e];a.isUndefined(m)&&k.error("EstimatedScoreSrv: subjectRawScoreEdges was not defined for the following subject: "+e);var n=m.max*j/l;return Math.max(n,m.min)}function n(a,b,c,d){return r(a,b).then(function(a){return c?d&&Math.abs(a-c)>.05*a?c+(a-c>0?1:-1)*a*.05:+a.toFixed(2):a})}function o(a,b,c){var d=b+"_"+c;return-1!==a.processedExercises.indexOf(d)?!0:void a.processedExercises.push(d)}b||k.error("EstimatedScoreSrv: subjectsRawScoreEdges was not set"),c||k.error("EstimatedScoreSrv: rawScoreToScoreFnGetter was not set !!!");var p=i.when(),q={},r=function(){var a=h.invoke(c);return function(b,c){return i.when(a(b,c))}}();return q.getEstimatedScores=l.bind(this,"estimatedScores"),q.getSectionsRawScores=l.bind(this,"sectionsRawScores"),q.getExercisesRawScore=l.bind(this,"exercisesRawScores"),q.getLatestEstimatedScore=function(b){return l("estimatedScores",b).then(function(c){if(a.isDefined(b))return c.length?c[c.length-1]:{};var d={};return a.forEach(c,function(a,b){d[b]=a.length?a[a.length-1]:{}}),d})},q.setDiagnosticSectionScore=function(a,b,c,g){return p=p.then(function(){return f.getEstimatedScoreData().then(function(h){if(h.estimatedScores[c].length){var j="Exercise already processed type "+b+" id "+g;return k.info(j),i.reject(j)}return a=Math.max(d,Math.min(e,a)),h.estimatedScores[c].push({exerciseType:b,exerciseId:g,score:a,time:Date.now()}),f.setEstimateScoreData(h).then(function(){return h.estimatedScores[c][h.estimatedScores[c].length-1]})})["catch"](function(a){k.info(a)})})},q.addRawScore=function(b,c,d,e,h){return p=p.then(function(){return f.getEstimatedScoreData().then(function(f){if(o(f,c,e)){var j="Exercise already processed type "+c+" id "+e;return i.reject(j)}if(c===g.SECTION["enum"]){var k=f.sectionsRawScores[d],l={exerciseType:c,exerciseId:e,time:Date.now()};a.extend(l,b),k.push(l)}else{var p=f.exercisesRawScores[d];p.exerciseType=c,p.exerciseId=e,p.time=Date.now(),p.total+=b.total,p.earned+=b.earned}if(!h){var q=m(f.sectionsRawScores[d],f.exercisesRawScores[d],d),r=f.estimatedScores[d],s=r[r.length-1]||{};return n(d,q,s.score,c!==g.SECTION["enum"]).then(function(a){return f.estimatedScores[d].push({exerciseType:c,exerciseId:e,score:a,time:Date.now()}),f})}return f}).then(function(a){return f.setEstimateScoreData(a)})["catch"](function(a){k.info(a)})})},q}]})}(angular),function(a){"use strict";a.module("znk.infra.exerciseResult").service("ExerciseResultSrv",["InfraConfigSrv","$log","$q","UtilitySrv","ExerciseTypeEnum","StorageSrv","ExerciseStatusEnum",function(b,c,d,e,f,g,h){function i(a){return v+"/"+a}function j(e,f,g){if(!a.isNumber(e)||!a.isNumber(f)){var h="exercise type id and exercise id should be number !!!";return c.error(h),d.reject(h)}var i=b.getStorageService(),j=b.getUserData();return j.then(function(a){return{exerciseId:f,exerciseTypeId:e,startedTime:i.variables.currTimeStamp,uid:a.uid,questionResults:[],guid:g}})}function k(a){var c=i(a),d=b.getStorageService();return d.get(c)}function l(){var a=b.getStorageService();return a.get(w)}function m(a){return x+"/"+a}function n(c,d){var f=b.getStorageService(),g=m(c);return f.get(g).then(function(b){var f=o(d,c);return f.then(function(d){return b.guid!==c?a.extend(b,d):e.object.extendWithoutOverride(b,d),b})})}function o(e,f){if(!a.isNumber(e)){var g="Exam id is not a number !!!";return c.error(g),d.reject(g)}var h=b.getUserData();return h.then(function(a){return{isComplete:!1,startedTime:"%currTimeStamp%",examId:e,guid:f,uid:a.uid,sectionResults:{}}})}function p(){var a=b.getStorageService();return a.get(y)}function q(){function c(a,b){var c=Math.round(a?b/a:0);return c}var e=this,j=s(),k={},l=0,n=0,o=0,p=0,q=0,v=0,w=e.questionResults.reduce(function(b,c){var d=a.isDefined(c.timeSpent)&&!isNaN(c.timeSpent)?c.timeSpent:0;return c.isAnsweredCorrectly?(l++,p+=d):a.isDefined(c.userAnswer)?(n++,q+=d):(o++,v+=d),b+(c.timeSpent||0)},0);e.duration=w,e.correctAvgTime=c(l,p),e.wrongAvgTime=c(n,q),e.skippedAvgTime=c(o,v),e.correctAnswersNum=l,e.wrongAnswersNum=n,e.skippedAnswersNum=o;var x=e.questionResults.length;e.avgTimePerQuestion=x?Math.round(w/x):0;var y=i(e.guid);return k[y]=e,j.then(function(a){a[e.exerciseTypeId]||(a[e.exerciseTypeId]={});var c=e.isComplete?h.COMPLETED["enum"]:h.ACTIVE["enum"];a[e.exerciseTypeId][e.exerciseId]=new t(c),k[z]=a;var i=d.when();return c===h.COMPLETED["enum"]&&e.exerciseTypeId===f.SECTION["enum"]&&(i=u.getExamResult(e.examId).then(function(b){if(r(b,a)){b.isComplete=!0,b.endedTime=g.variables.currTimeStamp;var c=m(b.guid);k[c]=b}})),i.then(function(){var a=b.getStorageService();return a.set(k),e})})}function r(a,b){var c=b[f.SECTION["enum"]],d=Object.keys(a.sectionResults);if(d.length!==+a.examSectionsNum)return!1;for(var e=0,g=d.length;g>e;e++){var i=d[e],j=c[i].status===h.COMPLETED["enum"];if(!j)return!1}return!0}function s(){var a=b.getStorageService();return a.get(z)}function t(a){this.status=a}var u=this,v="exerciseResults",w=g.variables.appUserSpacePath+"/exerciseResults",x="examResults",y=g.variables.appUserSpacePath+"/examResults",z=g.variables.appUserSpacePath+"/exercisesStatus";this.getExerciseResult=function(c,g,h,n,o){var p;return c===f.SECTION["enum"]&&(p=u.getExamResult(h,o)),l().then(function(f){var l=f[c]&&f[c][g];if(!l){if(o)return null;f[c]||(f[c]={});var q=b.getStorageService(),r=e.general.createGuid(),s={};f[c][g]=r,s[w]=f;var t=i(r),u=j(c,g,r);return u.then(function(a){s[t]=a;var b;return p&&(a.examId=h,b=p.then(function(a){a.sectionResults||(a.sectionResults={}),n&&!a.examSectionsNum&&(a.examSectionsNum=n),a.sectionResults[g]=r;var b=m(a.guid);s[b]=a})),d.when(b).then(function(){return q.set(s)}).then(function(a){return a[t]})})}return k(l).then(function(b){var d=j(c,g,l);return d.then(function(c){return b.guid!==l?a.extend(b,c):e.object.extendWithoutOverride(b,c),b})})}).then(function(b){return a.isObject(b)&&(b.$save=q),b})},this.getExamResult=function(a,c){var d=b.getStorageService();return p().then(function(b){var f=b[a];if(!f){if(c)return null;var g={},h=e.general.createGuid();b[a]=h,g[y]=b;var i=m(h),j=o(a,h);return j.then(function(a){return g[i]=a,d.set(g).then(function(a){return a[i]})})}return n(f,a)})},this.getExerciseStatus=function(a,b){return s().then(function(c){return c[a]&&c[a][b]?c[a][b]:new t(h.NEW["enum"])})},this.getExercisesStatusMap=function(){return s()}}])}(angular),function(a){"use strict";a.module("znk.infra.general").directive("autofocus",["$timeout",function(a){return{restrict:"A",link:function(b,c){a(function(){c[0].focus()},0,!1)}}}])}(angular),function(a){a.module("znk.infra.general").directive("compile",["$compile","$animate",function(b,c){return{link:function(d,e,f){var g,h=d.$watch(f.compile,function(i){if(g&&(g.$destroy(),g=null),c.leave(e.children()),e.empty(),"undefined"!=typeof i){d.$eval(f.bindOnce)&&h(),"string"!=typeof i&&(null===i&&(i=""),i=""+i);var j=/^<(\w+)( .*|)>(.|\n)*(<\/\1>|)$/;if(j.test(i)){g=d.$new();var k=a.element(i);c.enter(k,e),b(e.children())(g)}else e.append(i)}})}}}])}(angular),function(a){"use strict";a.module("znk.infra.general").directive("subjectIdToAttrDrv",["SubjectEnum","$interpolate",function(b,c){return{link:{pre:function(d,e,f){var g=[];d.$watch(f.subjectIdToAttrDrv,function(h){var i=f.contextAttr?c(f.contextAttr)(d):void 0,j=f.prefix?c(f.prefix)(d):void 0,k=f.suffix?c(f.suffix)(d):void 0;if(!a.isUndefined(h)){var l;i?l=i.split(","):(l=[],l.push("class"));var m=j?j.split(","):[],n=k?k.split(","):[],o=b.getEnumMap(),p=o[h];a.forEach(l,function(a,b){var c=p;if(m.length){var d=m[b]||m[0];""!==d&&(c=d+"-"+c)}if(n.length){var f=n[b]||n[0];""!==f&&(c+="-"+f)}c=c.replace(/\s+/g,""),a=a.replace(/\s+/g,""),"class"===a?e.hasClass(c)||(g.forEach(function(a){-1===a.indexOf(p)&&e.removeClass(a)}),g.push(c),e.addClass(c)):e.attr(a,c)})}})}}}}])}(angular),function(a){"use strict";a.module("znk.infra.general").directive("subjectIdToClassDrv",["SubjectEnum",function(b){return{priority:1e3,link:{pre:function(c,d,e){var f=c.$watch(e.subjectIdToClassDrv,function(c){if(!a.isUndefined(c)){f();var g;for(var h in b)if(b[h]["enum"]===c){g=b[h].val,e.classSuffix&&(g+=e.classSuffix);break}d.addClass(g)}})}}}}])}(angular),function(a){a.module("znk.infra.general").directive("timer",["$interval",function(b){var c={REGULAR:1,ROUND_PROGRESSBAR:2};return{scope:{play:"=?",typeGetter:"&?type",configGetter:"&?config"},require:"?ngModel",replace:!0,templateUrl:"components/general/templates/timerDrv.html",link:function(d,e,f,g){function h(a){return(""+Math.abs(+a)).length<2?(0>a?"-":"")+"0"+Math.abs(+a):a}function i(a,b){var c=a/1e3,d=Math.floor(c%60),e=Math.floor(Math.abs(c)/60)*(0>c?-1:1),f=h(d),g=h(e);return b.replace("tss",c).replace("ss",f).replace("mm",g)}function j(a){var b,c=i(a,d.config.format);switch(d.type){case 1:b=l.querySelector(".timer-view");break;case 2:b=l.querySelector(".timer-display")}b&&(b.innerText=c)}function k(){var b=g.$viewValue;a.isUndefined(b)||(b+=d.config.countDown?-n:n,d.config.stopOnZero&&0>=b&&(d.play=!1,b=0),j(b),g.$setViewValue(b))}var l=e[0];d.ngModelCtrl=g;var m,n=1e3;d.type=d.typeGetter()||1,d.config=d.configGetter()||{};var o={format:"mm:ss",stopOnZero:!0};switch(d.config=a.extend(o,d.config),d.type){case c.ROUND_PROGRESSBAR:var p={stroke:3,bgcolor:"#0a9bad",color:"#e1e1e1"};d.config=a.extend(p,d.config),d.config.radius=d.config.radius||Math.floor(e[0].offsetHeight/2)||45}g.$render=function(){var b=g.$viewValue;a.isUndefined(b)||j(b)},d.$watch("play",function(a){m&&b.cancel(m),a&&(m=b(k,n,0,!1))}),d.$on("$destroy",function(){b.cancel(m)})}}}])}(angular),function(a){a.module("znk.infra.general").directive("videoCtrlDrv",["$interpolate","$timeout",function(b,c){var d={FIT:"fit",COVER:"cover"};return{transclude:"element",priority:1e3,scope:{onEnded:"&?",onCanplay:"&?",onPlay:"&?",onVideoError:"&?",videoErrorPoster:"@?",actions:"=?",heightToWidthRatioGetter:"&heightToWidthRatio",videoHeight:"@"},link:function(e,f,g,h,i){function j(a){function b(b){c(function(){e.onVideoError&&e.onVideoError(b),e.videoErrorPoster&&(a.removeAttribute("controls"),a.poster=e.videoErrorPoster,a.style.display="")})}var d,f=a.querySelectorAll("source");d=f.length?f[f.length-1]:a,d.addEventListener("error",b),p.push({domElement:d,handler:b})}var k,l=f.parent(),m=l[0];if(g.customPoster){k=a.element('<img src="'+g.customPoster+'" style="position:absolute;top:0;right:0;bottom:0;left:0;">');var n=window.getComputedStyle(m);"static"===n.position&&(m.style.position="relative"),l.append(k)}var o;g.znkPosterDrv&&(o=new Image,o.src=b(g.znkPosterDrv)(e.$parent));var p=[];i(e.$parent,function(a){function b(){e.$apply(function(){e.onEnded()})}function f(a){var b,c,d=e.heightToWidthRatioGetter()||a;d=+d;var f=m.offsetWidth*d;f<=m.offsetHeight?(b=m.offsetWidth,c=f):(c=m.offsetHeight,b=c/d),b=Math.round(b),c=Math.round(c),s.style.width=b+"px",s.style.height=c+(c%2?0:1)+"px"}function g(a){s.style.position="relative";var b=m.offsetWidth*a;if(b>=m.offsetHeight)s.style.width=m.offsetWidth+"px",s.style.height=b+"px",s.style.top=-((b-m.offsetHeight)/2)+"px";else{var c=m.offsetHeight*(1/a);s.style.width=c+"px",s.style.height=m.offsetHeight+"px",s.style.left=-((c-m.offsetWidth)/2)+"px"}}function h(){k&&k.remove(),e.$apply(function(){e.onCanplay&&e.onCanplay()})}function i(){c(function(){e.onPlay&&e.onPlay()})}function n(a,b){if(!n.wasSet){n.wasSet=!0;var c=b,h=a,i=c/h;switch(e.videoHeight){case d.FIT:f(i);break;case d.COVER:g(i)}s.style.display=""}}function q(){n(this.videoHeight,this.videoWidth)}var r=a,s=r[0];j(s),s.style.display="none",l.append(r),e.actions=e.actions||{},e.actions.replay=function(){e.actions.stop(),s.play()},e.actions.play=function(){s.play()},e.actions.stop=function(){s.pause(),s.currentTime="0"},r.on("canplay",h),r.on("play",i),r.on("ended",b),o&&(o.onload=function(){n(o.width/2,o.height/2)}),s.addEventListener("loadedmetadata",q,!1),e.$on("$destroy",function(){r.off("canplay",h),r.off("play",i),r.off("ended",b),s.removeEventListener("loadedmetadata",q),p.forEach(function(a){a.domElement.removeEventListener("error",a.handler)}),o&&(o.onload=null),e.loadStart=!1})})}}}])}(angular),function(a){"use strict";a.module("znk.infra.hint").provider("HintSrv",function(){var b={},c={};this.registerHint=function(a,d,e){b[a]||(b[a]={name:a,action:d,determineWhetherToTriggerGetter:e}),c[a]=a},this.$get=["InfraConfigSrv","$q","$log","$injector",function(d,e,f,g){function h(){return m.get(n,o).then(function(a){return a})}function i(a){return m.set(n,a)}function j(a){return a&&a.history&&a.history.length&&a.history[a.history.length-1]}function k(b){return a.isUndefined(b)||!b.value}var l={},m=d.getStorageService(),n=m.variables.appUserSpacePath+"/hint",o={hintsStatus:{}};return l.hintMap=c,l.triggerHint=function(c){var d=b[c];return d||f.error("HintSrv: the following hint is not registered "+c),h().then(function(b){var f,h=b.hintsStatus,l=j(h[c]);return f=d.determineWhetherToTriggerGetter?g.invoke(d.determineWhetherToTriggerGetter):k,e.when(f(l)).then(function(f){if(f){var j=g.invoke(d.action);return e.when(j(l)).then(function(d){return h[c]||(h[c]={name:c,history:[]}),h[c].history.push({value:a.isUndefined(d)?!0:d,date:m.variables.currTimeStamp}),b.hintsStatus=h,i(b),d})}})})},l}]})}(angular),function(a){"use strict";a.module("znk.infra.config").provider("InfraConfigSrv",[function(){var a,b;this.setStorageServiceName=function(b){a=b},this.setUserDataFn=function(a){b=a},this.$get=["$injector","$log","$q",function(c,d,e){var f={};return f.getStorageService=function(){return a?c.get(a):void d.debug("InfraConfigSrv: storage service name was not defined")},f.getUserData=function(){var a;return b?(a=c.invoke(b),e.when(a)):void d.debug("InfraConfigSrv: auth fn name was not defined")},f}]}])}(angular),function(a){"use strict";a.module("znk.infra.pngSequence").directive("pngSequence",["$timeout","ExpansionSrcSrv","$window",function(b,c,d){return{restrict:"E",scope:{onEnded:"&",loop:"&",speed:"&",autoPlay:"&",actions:"="},link:function(e,f,g){function h(){var a,b=+g.startIndex,d=+g.endIndex;n=d-b;for(var e=b;d>e;e++){a=100>e||10>e?10>e?"00"+e:"0"+e:e;var h="<div  style=\"background-image: url('"+c.getExpansionSrc(g.imgData+a+".png")+"'); background-size: cover; will-change: opacity; opacity:0; position: absolute; top:0; left:0;\"></div>";f.append(h)}}function i(){f.empty()}function j(){this.index=0,this.imagesDomElem=f[0].children,this.lastTimestamp=!1}function k(c){this.index!==n-1||e.loop()?this.lastTimestamp&&c-this.lastTimestamp<40?o=d.requestAnimationFrame(k.bind(this)):(this.imagesDomElem[this.index].style.opacity=0,this.index=(this.index+1)%n,this.imagesDomElem[this.index].style.opacity=1,this.lastTimestamp=c,o=d.requestAnimationFrame(k.bind(this))):b(function(){var b=f.children();a.element(b[b.length-1]).css("display","none"),e.onEnded()})}function l(){if(i(),g.imgData&&a.isDefined(g.startIndex)&&g.endIndex&&(h(),e.autoPlay())){var b=new j;o=d.requestAnimationFrame(k.bind(b))}}function m(){return g.imgData+"_"+g.startIndex+"_"+g.endIndex+"_"+g.rotate}var n,o;e.$watch(m,l),e.actions=e.actions||{},
e.actions.play=function(){b(function(){var a=new j;o=d.requestAnimationFrame(k.bind(a))},0,!1)},e.actions.reset=i,e.$on("$destroy",function(){d.cancelAnimationFrame(o)})}}}])}(angular),function(){angular.module("znk.infra.popUp").factory("PopUpSrv",["$injector","$q","$rootScope","$animate","$document",function(a,b,c,d,e){function f(a,b,c,d,e){a=a?a+" base-popup show-hide-animation":"base-popup show-hide-animation",b=b||"";var f='<div class="icon-wrapper"><svg-icon name="%headerIcon%"></svg-icon></div>';f=f.replace("%headerIcon%",b);var g='<div class="title responsive-title">%title%</div><div class="content">%content%</div>';return c=c||"",g=g.replace("%title%",c),d=d||"",g=g.replace("%content%",d),h.popup(a,f,g,e)}function g(a,b,c,d){var e={text:a||"",type:b||""};return d?e.rejectVal=d:e.resolveVal=c,e}var h={},i=angular.element(e[0].body),j=angular.element('<div class="znk-popup"></div>');i.append(j);var k,l;return h.closePopup=function(a,b){b||(b="closed"),j.empty(),k.scope&&k.scope.$destroy(),l[a?"reject":"resolve"](b)},h.popup=function(e,f,g,i){k&&h.closePopup();var m=c.$new(!0);m.d={},l=b.defer(),k={},k.promise=l.promise;var n='<div class="%wrapperCls%"><div class="znk-popup-wrapper"><div class="znk-popup-header">%header%</div><div class="znk-popup-body">%body%</div><div class="znk-popup-buttons"><div ng-repeat="button in ::d.buttons" class="button-wrapper"><div class="btn" ng-click="d.btnClick(button)" ng-class="button.type"> {{button.text}}</div></div></div></div></div>';e=e?" "+e:"",n=n.replace("%wrapperCls%",e),f=f||"",n=n.replace("%header%",f),g=g||"",n=n.replace("%body%",g),angular.isDefined(i)&&!angular.isArray(i)&&(i=[i]),m.d.buttons=i,m.d.btnClick=function(a){a.hasOwnProperty("rejectVal")?m.d.close(a.rejectVal,!0):m.d.close(a.resolveVal)},m.d.close=function(a,b){var c=d.leave(o);c.then(function(){if(m&&(m.$destroy(),m=null),k=null,angular.isDefined(l)&&null!==l){var c=b?"reject":"resolve";a=a||"close",l[c]&&l[c](a),l=null}})};var o=angular.element(n);d.enter(o,j);var p=a.get("$compile");return p(j.contents())(m),k},h.error=function(a,b){var c=new g("OK",null,"ok");return f("error-popup","exclamation-mark",a||"OOOPS...",b,[c])},h.ErrorConfirmation=function(a,b,c,d){var e=[new g(c,null,c),new g(d,"btn-outline",void 0,d)];return f("error-popup","exclamation-mark",a,b,e)},h.success=function(a,b){var c=new g("OK",null,"ok");return f("success-popup","exclamation-mark",a||"",b,[c])},h.warning=function(a,b,c,d){var e=[new g(c,null,c),new g(d,"btn-outline",void 0,d)];return f("warning-popup","exclamation-mark",a,b,e)},h.isPopupOpen=function(){return!!k},h}])}(),function(a){"use strict";a.module("znk.infra.scroll").directive("znkScroll",["$log","$window","$timeout","$interpolate",function(b,c,d,e){function f(b,c,d,e,f){var h=a.isArray(b)?b[0]:b,i=c;if(d){var j,k=h.style.transform,l=k.match(/translateX\((.*)px\)/);j=!a.isArray(l)||l.length<2?0:+l[1],i+=j}e=a.isUndefined(e)?-(1/0):e,f=a.isUndefined(f)?1/0:f,i=Math.max(i,e),i=Math.min(i,f);var m="translateX("+i+"px)";g(h,"transform",m)}function g(b,c,d){var e=a.isArray(b)?b[0]:b;null===d?e.style[c]="":e.style[c]=d}function h(b){var d=a.isArray(b)?b[0]:b,e=c.getComputedStyle(d),f=+e.marginRight.replace("px",""),g=+e.marginLeft.replace("px","");return d.offsetWidth+f+g}return{restrict:"E",compile:function(b){function c(a){var b=a.pageX-m.x;m.x=a.pageX,m.y=a.pageY,k(b,n,o)}function i(){document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",i),n=null,o=null,m=null}function j(a){var b=p.children[0];b&&(n=p.offsetWidth,o=h(b),m={x:a.pageX,y:a.pageY},document.addEventListener("mousemove",c),document.addEventListener("mouseup",i))}function k(a,b,c){var d=Math.min(b-c,0),e=0,g=p.children[0];g.style.transform||f(g,0,!1,!1,d,e),f(g,a,!0,d,e)}function l(a){var b=p.offsetWidth,c=p.children[0],d=h(c),e=Math.min(b-d,0),g=0;f(c,a,!1,e,g)}var m,n,o,p=b[0],q="wheel";return p.addEventListener("mousedown",j),{pre:function(b,i,m){function n(a){var b=4*-a.deltaY;k(b,t,u)}function o(){t=p.offsetWidth,u=h(p.children[0]),p.addEventListener(q,n)}function r(){p.removeEventListener(q,n)}var s=p.children[0];s&&f(s,0);var t,u,v="false"!==e(m.scrollOnMouseWheel||"")(b);if(v&&(p.addEventListener("mouseenter",o),p.addEventListener("mouseleave",r)),m.actions){a.isUndefined(b.$eval(m.actions))&&b.$eval(m.actions+"={}");var w=b.$eval(m.actions);w.animate=function(a,b,c){if(b&&c){var e="transform "+b+"ms "+c;g(s,"transition",e)}l(a),d(function(){g(s,"transition",null)},b,!1)}}b.$on("$destroy",function(){document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",r),p.removeEventListener("mousedown",j),p.removeEventListener("mouseenter",o),p.removeEventListener("mouseleave",r),p.removeEventListener(q,n)})}}}}}])}(angular),function(a){"use strict";a.module("znk.infra.stats").factory("StatsEventsHandlerSrv",["$rootScope","exerciseEventsConst","StatsSrv","ExerciseTypeEnum","$log","UtilitySrv",function(b,c,d,e,f,g){function h(b,c,e,h){return d.isExerciseStatsRecorded(b,e.id).then(function(c){if(!c){var i={},j=g.array.convertToMap(e.questions);return h.questionResults.forEach(function(b){var c=j[b.questionId],e=c.categoryId;if(isNaN(+e)||null===e)return void f.error("StatsEventsHandlerSrv: _eventHandler: bad category id for the following question: ",c.id,e);i[e]||(i[e]=new d.BaseStats);var g=i[e];g.totalQuestions++,g.totalTime+=b.timeSpent||0,a.isUndefined(b.userAnswer)?g.unanswered++:b.isAnsweredCorrectly?g.correct++:g.wrong++}),d.updateStats(i,b,e.id)}})}var i={},j=b.$new(!0),k=[],l=e.getEnumArr();return l.forEach(function(a){var b=a.val.toLowerCase();k.push({evt:c[b].FINISH,exerciseType:a["enum"]})}),k.forEach(function(a){j.$on(a.evt,h.bind(i,a.exerciseType))}),i.init=a.noop,i}])}(angular),function(a){"use strict";a.module("znk.infra.stats").service("StatsQuerySrv",["StatsSrv","$q",function(b,c){function d(a){return a.totalQuestions?(a.totalQuestions-a.correct)/a.totalQuestions:-(1/0)}function e(){function b(b){return a.isUndefined(c.weakness)||c.weakness<b}var c={};this.proccessCategory=function(a){var e=d(a);b(e)&&(c.weakness=e,c.category=a)},this.getWeakestCategory=function(){return c.category}}var f={};return f.getWeakestCategoryInLevel=function(d,f,g){function h(b){if(!f.length&&a.isUndefined(g))return!0;var c=b.id;if(f.length&&-1===f.indexOf(c))return!1;var d=b.parentsIds;return a.isDefined(g)&&-1===d.indexOf(g)?!1:!0}return a.isArray(f)||(f=[]),b.getLevelStats(d).then(function(d){var g=c.when(),i={};if(f.length){var j=[];f.forEach(function(a){var c=b.getCategoryKey(a);if(d&&d[c])i[c]=d[c];else{var e=b.getAncestorIds(a).then(function(d){i[c]=new b.BaseStats(a,!0),i[c].parentsIds=d});j.push(e)}}),g=c.all(j)}else g=c.when(),i=d;return g.then(function(){var b=new e;return a.forEach(i,function(a){h(a)&&b.proccessCategory(a)}),b.getWeakestCategory()})})},f}])}(angular),function(a){"use strict";a.module("znk.infra.stats").provider("StatsSrv",function(){var b;this.setCategoryLookup=function(a){b=a},this.$get=["InfraConfigSrv","$q","SubjectEnum","$log","$injector",function(c,d,e,f,g){function h(b,c){a.isDefined(b)&&(this.id=+b);var d,e,f,g,h;c?(d=5,e=1,f=0,g=4,h=0):(d=0,e=0,f=0,g=0,h=0),this.totalQuestions=d,this.correct=e,this.unanswered=f,this.wrong=g,this.totalTime=h}function i(){var a={processedExercises:{}};return n.get(o,a)}function j(a){return n.set(o,a)}function k(a,b){a.totalQuestions+=b.totalQuestions,a.correct+=b.correct,a.unanswered+=b.unanswered,a.wrong+=b.wrong,a.totalTime+=b.totalTime}function l(a,b){return a[b]?a[b].parentId:a[b]}function m(a,b){return a+"_"+b}b||f.error("StatsSrv: getCategoryLookup was not set !!!!");var n=c.getStorageService(),o=n.variables.appUserSpacePath+"/stats",p={},q=function(){return g.invoke(b).then(function(a){return a})};return p.getLevelKey=function(a){return"level"+a+"Categories"},p.getCategoryKey=function(a){return"id_"+a},p.getAncestorIds=function(b){var c=[];return q().then(function(d){for(var e=l(d,+b);null!==e&&a.isDefined(e);)c.push(e),e=l(d,e);return c})},p.getStats=i,p.getLevelStats=function(a){var b=p.getLevelKey(a);return i().then(function(a){return a[b]})},p.BaseStats=h,p.updateStats=function(b,c,e){var f=m(c,e);return i().then(function(c){var e=c.processedExercises[f];if(!e){var g=[];return a.forEach(b,function(a,b){var d=p.getAncestorIds(b).then(function(d){d.unshift(+b);var e=d.length;d.forEach(function(b,f){var g=e-f,i=p.getLevelKey(g),j=c[i];j||(j={},c[i]=j);var l=p.getCategoryKey(b),m=j[l];if(!m){m=new h(b,!0);var n=d.slice(f+1);n.length&&(m.parentsIds=n),j[l]=m}k(m,a)})});g.push(d)}),d.all(g).then(function(){return c.processedExercises[f]=!0,j(c)})}})},p.isExerciseStatsRecorded=function(a,b){return p.getStats().then(function(c){var d=m(a,b);return!!c.processedExercises[d]})},p}]})}(angular),function(a){"use strict";a.module("znk.infra.storage").factory("storageFirebaseAdapter",["$log","$q","StorageSrv",function(b,c,d){function e(c){if(a.isArray(c))return void c.forEach(function(b,d){a.isUndefined(b)&&(c[d]=null),e(b)});if(a.isObject(c)){var d=Object.keys(c);return void d.forEach(function(d){var f=c[d];return"$"===d[0]||a.isUndefined(f)||a.isArray(f)&&!f.length||f!==f?(b.debug("storageFirebaseAdapter: illegal property was deleted before save",d),void delete c[d]):(a.isString(f)&&(c[d]=h(f)),void e(f))})}}function f(d){function f(a){var b=g(a,j);return k[b]||(k[b]=k.rootRef.child(b)),k[b]}function h(a){var d=c.defer(),e=f(a);return e.once("value",function(a){d.resolve(a.val())},function(c){b.debug("storageFirebaseAdapter: failed to retrieve data for the following path",a,c),d.reject(c)}),d.promise}function i(d,h){var i=c.defer();if(a.isObject(d)){var l={};a.forEach(d,function(b,c){var d=g(c,j);l[d]=a.copy(b)}),e(l),k.rootRef.update(l,function(a){a&&i.reject(a),i.resolve()})}else{var m=a.copy(h);e(m);var n=f(d);n.set(m,function(a){a?(b.debug("storageFirebaseAdapter: failed to set data for the following path",d,a),i.reject(a)):i.resolve(m)})}return i.promise}var j,k={},l=new Firebase(d);return k.rootRef=l,l.onAuth(function(a){j=a}),{get:h,set:i,__refMap:k}}function g(a,b){var c=a.replace(k,b.uid);return c}function h(a){return a===d.variables.currTimeStamp?Firebase.ServerValue.TIMESTAMP:a}var i=d.variables,j=i.uid.replace(/\$/g,"\\$"),k=new RegExp(j,"g");return f.processPath=function(a,b){var c=a.replace(k,b.uid);return c},f}])}(angular),function(a){"use strict";a.module("znk.infra.storage").factory("StorageSrv",["$cacheFactory","$q",function(b,c){function d(a,d){this.getter=function(b){return c.when(a(b))},this.setter=function(a,b){return c.when(d(a,b))},this.entityCache=b("entityCache"+g),g++}function e(a,b,c){this.path=a,this.defaultValue=b,this.storage=c}var f={},g=0;return d.prototype.get=function(b,d){var e,g=this,h=this.entityCache.get(b);d=d||{};var i=!1;if(h)e=c.when(h);else{if(f[b])return f[b];i=!0,e=this.getter(b).then(function(c){if((a.isUndefined(c)||null===c)&&(c={}),a.isObject(c)){var d=Object.create({$save:function(){return g.set(b,this)}});c=a.extend(d,c)}return g.entityCache.put(b,c),delete f[b],c})}return e=e.then(function(b){var c=Object.keys(d);return c.forEach(function(c){a.isUndefined(b[c])&&(b[c]=a.copy(d[c]))}),b}),i&&(f[b]=e),e},d.prototype.set=function(b,c){var d=this;return this.setter(b,c).then(function(){var e={};a.isObject(b)?e=b:e[b]=c;var f={};return a.forEach(e,function(b,c){var e;a.isObject(b)&&!b.$save?(e=Object.create({$save:function(){return d.set(c,this)}}),a.forEach(b,function(a,b){e[b]=a})):e=b,f[c]=e,d.entityCache.put(c,e)}),a.isObject(b)?f:f[b]})},d.prototype.entityCommunicator=function(a,b){return new e(a,b,this)},d.prototype.cleanPathCache=function(a){this.entityCache.remove(a)},d.variables=d.prototype.variables={currTimeStamp:"%currTimeStamp%",uid:"$$uid",appUserSpacePath:"users/$$uid"},e.prototype.get=function(){return this.storage.get(this.path)},e.prototype.set=function(a){return this.storage.set(this.path,a)},d}])}(angular),function(a){"use strict";a.module("znk.infra.svgIcon").directive("svgIcon",["$log","SvgIconSrv",function(a,b){return{scope:{name:"@"},link:{pre:function(a,c){function d(a){c.addClass(a),b.getSvgByName(a).then(function(a){c.append(a)})}function e(){return c.attr("name")}a.$watch(e,function(a,b){c.empty(),b&&c.removeClass(b),a&&d(a)})}}}}])}(angular),function(a){"use strict";a.module("znk.infra.svgIcon").provider("SvgIconSrv",[function(){var b={};this.setConfig=function(c){a.extend(b,c)};var c={};this.registerSvgSources=function(b){var d=Object.keys(c);return d.forEach(function(a){b[a]&&console.log("SvgIconSrv: svg icon was already defined before ",a)}),a.extend(c,b),!0};var d={};this.$get=["$templateCache","$q","$http","$log",function(a,b,e,f){var g={};return g.getSvgByName=function(g){var h=c[g];if(!h)return f.error("SvgIconSrv: src is missing for the following name",g),b.reject("no source was found");if(d[h])return d[h];var i=a.get(h);if(i)return b.when(i);var j=e.get(h).then(function(b){return a.put(h,b.data),delete d[h],b.data});return d[h]=j,j},g}]}])}(angular),function(a){"use strict";a.module("znk.infra.utility").factory("UtilitySrv",["$q",function(b){var c={};return c.general={},c.general.createGuid=function(){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase()},c.object={},c.object.extendWithoutOverride=function(b,c){a.forEach(c,function(a,c){b.hasOwnProperty(c)||(b[c]=a)})},c.object.convertToArray=function(b){var c=[];return a.forEach(b,function(a){c.push(a)}),c},c.array={},c.array.convertToMap=function(b,c){a.isUndefined(c)&&(c="id");var d={};return b.forEach(function(a){d[a[c]]=a}),d},c.fn={},c.fn.singletonPromise=function(c){var d;return function(){return d||(d=b.when(a.isFunction(c)?c():c)),d}},c}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("answerBuilder",["$compile","AnswerTypeEnum","ZnkExerciseUtilitySrv","ZnkExerciseViewModeEnum",function(b,c,d,e){var f={};return f[c.SELECT_ANSWER["enum"]]="<select-answer></select-answer>",f[c.FREE_TEXT_ANSWER["enum"]]="<free-text-answer></free-text-answer>",f[c.RATE_ANSWER["enum"]]="<rate-answer></rate-answer>",{require:["answerBuilder","^questionBuilder","^ngModel"],restrict:"E",controller:[function(){}],link:{pre:function(c,g,h,i){var j=i[0],k=i[1],l=i[2],m=["getViewMode","getCurrentIndex"];d.bindFunctions(j,k,m),j.canUserAnswerBeChanged=function(){var b=k.getViewMode(),c=b!==e.REVIEW["enum"],d=a.isDefined(l.$viewValue),f=b===e.ANSWER_WITH_RESULT["enum"];return c&&f&&d},j.question=k.question;var n=k.question.answerTypeId,o=f[n];g.html(o),b(g.contents())(c)}}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("freeTextAnswer",["ZnkExerciseViewModeEnum","$timeout",function(b,c){return{templateUrl:"components/znkExercise/answerTypes/templates/freeTextAnswerDrv.html",require:["^ngModel","^answerBuilder"],scope:{},link:function(d,e,f,g){function h(b){var c=k.question.correctAnswerText,e=k.getViewMode();d.correctAnswer=c[0].content,e===l||e===n?(d.d.userAnswer=a.isDefined(b)?b:"",d.showCorrectAnswer=!1):a.isUndefined(b)?(d.userAnswerStatus="neutral",d.showCorrectAnswer=e===m):(i(b,c)?d.userAnswerStatus="correct":d.userAnswerStatus="wrong",d.showCorrectAnswer=!0,d.d.userAnswer=b)}function i(a,b){for(var c=0;c<b.length;c++)if(a===b[c].content)return!0;return!1}var j=g[0],k=g[1];d.d={};var l=b.ONLY_ANSWER["enum"],m=b.REVIEW["enum"],n=b.MUST_ANSWER["enum"],o=/(?: |^)\d*\.?\d+(?: |$)|(?: |^)\d*\/?\d+(?: |$)/;d.clickHandler=function(a){o.test(a)&&(j.$setViewValue(a),h(a))},j.$render=function(){c(function(){h(j.$viewValue)})},j.$render()}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("rateAnswer",["ZnkExerciseViewModeEnum",function(b){return{templateUrl:"components/znkExercise/answerTypes/templates/rateAnswerDrv.html",require:["^answerBuilder","^ngModel"],scope:{},link:function(c,d,e,f){function g(a){j.canUserAnswerBeChanged()||(k.$setViewValue(a),h())}function h(){var b=a.element(i.querySelector(".selected"));b.removeClass("selected");var c=k.$viewValue,d=a.element(p[c]);d.addClass("selected");var e=q.length-1;if(l===m&&a.isNumber(c)||l===n){for(var f=0;e>f;f++)a.element(p[q[f].id-o]).addClass("correct");a.element(p[q[e].id-o]).addClass("correct-edge")}!a.isNumber(c)||l!==n&&l!==m||(c>=q[0].id-o&&c<=q[e].id-o?a.element(p[c]).addClass("selected-correct"):a.element(p[c]).addClass("selected-wrong"))}var i=d[0],j=f[0],k=f[1],l=j.getViewMode(),m=b.ANSWER_WITH_RESULT["enum"],n=b.REVIEW["enum"],o=2;c.d={},c.d.itemsArray=new Array(11);var p,q=j.question.correctAnswerText,r=c.$watch(function(){return d[0].querySelectorAll(".item-repeater")},function(b){b&&(r(),p=b,l===n?(c.clickHandler=a.noop,h(c.d.answers)):c.clickHandler=g,k.$render=function(){h()},k.$render())})}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("selectAnswer",["$timeout","ZnkExerciseViewModeEnum","ZnkExerciseAnswersSrv","ZnkExerciseEvents",function(b,c,d,e){return{templateUrl:"components/znkExercise/answerTypes/templates/selectAnswerDrv.html",require:["^answerBuilder","^ngModel"],restrict:"E",scope:{},link:function(f,g,h,i){function j(b){b=String.fromCharCode(b.keyCode).toUpperCase(),a.isDefined(u[b])&&f.d.click(f.d.answers[u[b]])}function k(b){for(var c=m.$viewValue,d=l.question.correctAnswerId,e=a.element(g[0].querySelectorAll(".answer")),f=0;f<e.length;f++){var h=a.element(e[f]);if(h&&h.scope&&h.scope()){var i,j,k=h.scope().answer;l.getViewMode()===r||l.getViewMode()===t?(j="answered",i=c===k.id?"answered":"neutral"):a.isUndefined(c)?l.getViewMode()===s&&(i=d===k.id?"answered-incorrect":"neutral"):i=c===k.id?d===k.id?"correct":"wrong":k.id===d?"answered-incorrect":"neutral",h.removeClass(j),h.addClass(i)}}}var l=i[0],m=i[1],n=l.question.__questionStatus.index,o=l.getCurrentIndex(),p=document.body,q=c.ANSWER_WITH_RESULT["enum"],r=c.ONLY_ANSWER["enum"],s=c.REVIEW["enum"],t=c.MUST_ANSWER["enum"],u={};f.d={},f.d.answers=l.question.answers,f.d.click=function(a){var b=l.getViewMode();!isNaN(parseInt(m.$viewValue))&&b===q||b===s||(m.$setViewValue(a.id),k(b))},n===o&&p.addEventListener("keydown",j),f.$on(e.QUESTION_CHANGED,function(a,b,c,d){var e=d.__questionStatus.index;n!==e?p.removeEventListener("keydown",j):p.addEventListener("keydown",j)}),f.d.getIndexChar=function(a){var b=d.selectAnswer.getAnswerIndex(a,l.question);return u[b]=a,b},m.$render=function(){b(function(){k()})},m.$render(),f.$on("exercise:viewModeChanged",function(){m.$render()}),f.$on("$destroy",function(){p.removeEventListener("keydown",j)})}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").provider("ZnkExerciseAnswersSrv",function(){this.config={selectAnswer:{}};var b={};this.config.selectAnswer.setAnswerIndexFormatter=function(a){b.answerIndexFormatter=a},this.$get=[function(){var c={selectAnswer:{}};return c.selectAnswer.getAnswerIndex=function(c){var d;if(b.answerIndexFormatter&&(d=b.answerIndexFormatter.apply(this,arguments)),a.isUndefined(d)){var e=65;d=String.fromCharCode(e+c)}return d},c}]})}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("freeTextAnswerGrid",[function(){return{templateUrl:"scripts/exercise/templates/freeTextAnswerGridDrv.html",restrict:"E",require:"ngModel",scope:{cellsNumGetter:"&cellsNum"},link:function(b,c,d,e){function f(){e.$setViewValue(a.copy(b.d.cells))}b.buttonArray=[1,2,3,4,5,6,7,8,9];var g=b.cellsNumGetter()||3;b.d={viewCells:new Array(g)},b.onClickNum=function(a){d.disabled||b.d.cells.length>=g||(b.d.cells.push(a),f())},b.onClickErase=function(){!d.disabled&&b.d.cells.length&&(b.d.cells.pop(),f())},e.$render=function(){b.d.cells=a.isDefined(e.$viewValue)?e.$viewValue:[]}}}}])}(angular),function(a){a.module("znk.infra.znkExercise").directive("markup",["$window",function(b){var c=!1,d=275,e=a.element("<P/>");return{replace:!0,restrict:"E",link:function(f,g,h){var i=function(a){return e.append(a),e.contents()},j=function(a){var b={width:"",height:""};if(a.style.width){var c=a.style.height,e=a.style.width;if(c=c.replace("px",""),e=e.replace("px",""),!isNaN(e)){for(e=parseInt(e);e>d;)e=.9*e,c=.9*c;b.width=e+"px",b.height=c+"px"}}return b},k=function(b){for(var c,d=0;d<b.length;d++)if(b[d].tagName&&"img"===b[d].tagName.toLowerCase())b[d].style.width&&(c=j(b[d]),b[d].style.width=c.width,b[d].style.height=c.height);else{var e=a.element(b[d]).find("img");if(e.length)for(var f=0;f<e.length;f++)e[f].style.width&&(c=j(e[f]),e[f].style.width=c.width,e[f].style.height=c.height)}return b},l=function(a){for(var b=0;b<a.length;b++)if(a[b].tagName&&"p"===a[b].tagName.toLowerCase()){if(!a[b].style)break;var c=a[b].style.marginLeft;c=c?c.replace("px",""):c,c&&!isNaN(c)&&(a[b].style.marginLeft=0)}return a},m=f.$watch(h.content,function(a){if(a){d=c?b.innerWidth/1.05:b.innerWidth/1.25;var e=i(a);if(e){var f=k(e);f=l(f),g.append(f)}m()}})}}}])}(angular),function(a){a.module("znk.infra.znkExercise").directive("arrayToStringFmtr",[function(){return{require:"ngModel",link:function(a,b,c,d){function e(a){return a&&a.length?a.join(""):void 0}function f(a){return a&&a.length?a.match(/.{1}/g):[]}d.$parsers.push(e),d.$formatters.push(f)}}}])}(angular),function(a){"use strict";var b={BOOKMARK:"znk exercise:bookmark",QUESTION_ANSWERED:"znk exercise:question answered",READY:"znk exercise: exercise ready",QUESTION_CHANGED:"znk exercise: question changed",QUESTIONS_NUM_CHANGED:"znk exercise: questions num changed",SLIDE_DIRECTION_CHANGED:"znk exercise: slide direction changed"};a.module("znk.infra.znkExercise").constant("ZnkExerciseEvents",b)}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("questionBuilder",["$compile","QuestionTypesSrv","$timeout","ZnkExerciseUtilitySrv",function(a,b,c,d){return{restrict:"E",require:["questionBuilder","^znkExercise"],scope:{questionGetter:"&question"},controller:["$scope",function(a){var b=this;b.question=a.questionGetter()}],link:{pre:function(a,b,c,e){var f=e[0],g=e[1],h=["getViewMode","addQuestionChangeResolver","removeQuestionChangeResolver","getCurrentIndex"];d.bindFunctions(f,g,h)},post:function(d,e,f,g){var h=g[0],i=g[1];b.getQuestionHtmlTemplate(h.question).then(function(b){var c=b;e.append(c);var f=d.$new(!0);a(e.contents())(f)});var j;c(function(){j=c(function(){i.notifyQuestionBuilderReady(h.question.__questionStatus.index)})},0,!1),d.$on("$destroy",function(){c.cancel(j)})}}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("questionsCarousel",["ZnkExerciseSrv","PlatformEnum","$log","ZnkExerciseSlideDirectionEnum",function(a,b,c,d){return{templateUrl:function(){var d="components/znkExercise/core/template/",e=a.getPlatform();switch(e){case b.DESKTOP["enum"]:d+="questionSwiperDesktopTemplate.html";break;case b.MOBILE["enum"]:d+="questionSwiperMobileTemplate.html"}return d||c.error("znkExerciseBtnSectionDrv directive: template was not defined for platform"),d},require:"ngModel",scope:{questionsGetter:"&questions",onQuestionAnswered:"&"},link:function(a,b,c,e){a.vm={},e.$render=function(){a.vm.currSlideIndex=e.$viewValue},a.vm.SlideChanged=function(){e.$setViewValue(a.vm.currSlideIndex)},c.$observe("slideDirection",function(b){var c=+b;if(a.vm.swiperActions&&!isNaN(c))switch(c){case d.NONE["enum"]:a.vm.swiperActions.lockSwipes();break;case d.RIGHT["enum"]:a.vm.swiperActions.unlockSwipeToPrev(),a.vm.swiperActions.lockSwipeToNext();break;case d.LEFT["enum"]:a.vm.swiperActions.lockSwipeToPrev(),a.vm.swiperActions.unlockSwipeToNext();break;default:a.vm.swiperActions.unlockSwipes()}}),a.$watch("questionsGetter().length",function(b){var c=a.questionsGetter();return b&&!a.vm.questions?void(a.vm.questions=c):(a.vm.questions=c,void a.vm.swiperActions.updateFollowingSlideAddition())})}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("rateAnswerFormatterParser",["AnswerTypeEnum",function(b){return{require:["ngModel","questionBuilder"],link:function(c,d,e,f){var g=f[0],h=f[1],i=h.question.answerTypeId;if(i===b.RATE_ANSWER["enum"]){var j=2;g.$formatters.push(function(b){return a.isDefined(b)?b-j:void 0}),g.$parsers.push(function(b){return a.isDefined(b)?b+j:void 0})}}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("znkExerciseBtnSection",["ZnkExerciseSrv","PlatformEnum","$log","ZnkExerciseEvents","ZnkExerciseViewModeEnum","$q","ZnkExerciseSlideDirectionEnum",function(a,b,c,d,e,f,g){return{restrict:"E",scope:{prevQuestion:"&?",nextQuestion:"&?",onDone:"&",questionsGetter:"&questions",actions:"="},require:"^znkExercise",templateUrl:function(){var d="components/znkExercise/core/template/",e=a.getPlatform();switch(e){case b.DESKTOP["enum"]:d+="btnSectionDesktopTemplate.html";break;case b.MOBILE["enum"]:d+="btnSectionMobileTemplate.html"}return d||c.error("znkExerciseBtnSectionDrv directive: template was not defined for platform"),d},link:{pre:function(a,b,c,h){function i(b){a.vm.currentQuestionIndex=b||0}function j(){return p!==e.REVIEW["enum"]}function k(a,b){return a&&a===b.length-1}function l(){var a=h.getQuestions(),b=h.areAllQuestionsAnswered();f.all([a,b]).then(function(a){if(!q){var b=a[0],c=a[1],d=h.getCurrentIndex();m(j()&&(k(d,b)||c)?!0:!1)}})}function m(b){a.vm.showDoneButton=!!b;var c=h.getElement();b?c.addClass("done-btn-show"):c.removeClass("done-btn-show")}function n(){h.getQuestions().then(function(b){a.vm.maxQuestionIndex=b.length-1}),i(h.getCurrentIndex())}function o(b){var c=37,d=39;switch(b.keyCode){case c:a.vm.prevQuestion();break;case d:a.vm.nextQuestion()}}var p=h.getViewMode();a.vm={},a.actions||(a.actions={});var q;a.actions.forceDoneBtnDisplay=function(a){q=a===!1||a===!0,q?m(a):l()},n(),a.vm.prevQuestion=function(){a.prevQuestion()},a.vm.nextQuestion=function(){a.nextQuestion()},h.notifyBtnSectionReady(),a.$on(d.QUESTION_CHANGED,function(a,b){i(b),l(b)}),a.$on(d.QUESTION_ANSWERED,function(){var a=h.getCurrentIndex();l(a)}),a.$on(d.QUESTIONS_NUM_CHANGED,function(b,c){var d=h.getCurrentIndex();a.vm.maxQuestionIndex=c-1,l(d)}),a.$on(d.SLIDE_DIRECTION_CHANGED,function(b,c){var d=g.getNameToEnumMap();switch(c){case d.NONE:a.vm.slideLeftAllowed=a.vm.slideRightAllowed=!1;break;case d.LEFT:a.vm.slideLeftAllowed=!0,a.vm.slideRightAllowed=!1;break;case d.RIGHT:a.vm.slideLeftAllowed=!1,a.vm.slideRightAllowed=!0;break;default:a.vm.slideLeftAllowed=a.vm.slideRightAllowed=!0}});var r=document.body;r.addEventListener("keydown",o);var s;j()&&(s=function(){return h.isCurrentQuestionAnswered()},a.$watch(s,function(b){a.vm.isCurrentQuestionAnswered=!!b})),a.$on("$destroy",function(){r.removeEventListener("keydown",o)})}}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("znkSwiper",["$timeout","$q",function(b,c){return{templateUrl:"components/znkExercise/core/template/znkSwiperTemplate.html",replace:!0,restrict:"E",require:"ngModel",scope:{},transclude:!0,compile:function(){function d(b,c,d,e){if(d.actions){b.$parent.$eval(d.actions)||b.$parent.$eval(d.actions+"={}");var f=b.$parent.$eval(d.actions),h=["lockSwipes","lockSwipeToPrev","lockSwipeToNext","unlockSwipes","unlockSwipeToPrev","unlockSwipeToNext","noSwiping"];h.forEach(function(a){f[a]=function(){var b=arguments;g.then(function(c){c[a].apply(c,b)})}}),f.updateFollowingSlideAddition=function(){return g.then(function(a){a.updateContainerSize(),a.updateSlidesSize()})}}e.$render=function(){var b=e.$viewValue;a.isNumber(b)&&g.then(function(a){a.slideTo(b)})},g.then(function(a){a.on("onSlideChangeEnd",function(a){e.$setViewValue(a.activeIndex)})}),b.$on("$destroy",function(){g.then(function(a){a.destroy()})})}function e(a,c,d,e){b(function(){var a=e.$viewValue;f.resolve(new Swiper(c[0],{initialSlide:a||0,onlyExternal:!0}))},0,!1)}var f=c.defer(),g=f.promise;return{pre:d,post:e}}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").provider("QuestionTypesSrv",function(){var b={};this.setQuestionTypesHtmlTemplate=function(a){b=a};var c=a.noop;this.setQuestionTypeGetter=function(a){c=a},this.$get=["$log","$q",function(a,d){var e={};return e.getQuestionHtmlTemplate=function(e){return d.when(c(e)).then(function(c){var d=c;return b[d]||a.error("QuestionTypesSrv: Template was not registered for the following question type:",d),b[d]})},e}]})}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").factory("ZnkExerciseSrv",["EnumSrv","$window","PlatformEnum",function(a,b,c){var d={},e=b.ionic?c.MOBILE["enum"]:c.DESKTOP["enum"];return d.getPlatform=function(){return e},d.openExerciseToolBoxModal=function(){},d.toolBoxTools={BLACKBOARD:"blackboard",MARKER:"mar",CALCULATOR:"cal",BOOKMARK:"bookmark",SHOW_PAGER:"show pager"},d}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("znkExercise",["ZnkExerciseSrv","$location","$window","$q","ZnkExerciseEvents","PlatformEnum","$log","ZnkExerciseViewModeEnum","ZnkExerciseSlideDirectionEnum","$timeout","ZnkExerciseUtilitySrv",function(b,c,d,e,f,g,h,i,j,k,l){return{templateUrl:"components/znkExercise/core/template/znkExerciseDrv.html",restrict:"E",transclude:!0,controllerAs:"vm",require:["znkExercise","ngModel"],scope:{questionsGetter:"&questions",settings:"=?",actions:"=?"},controller:"ZnkExerciseDrvCtrl",compile:function(c){var m=b.getPlatform();m||h.$error("znkExercise directive: undefined platform received.");var n=g.getEnumMap();return c.addClass(n[m]),{pre:function(c,g,m,n){function o(a,b){var d=c.vm.slideDirection;switch(d){case j.NONE["enum"]:return e.reject();case j.RIGHT["enum"]:return b>a?!0:e.reject(!1);case j.LEFT["enum"]:return a>b?!0:e.reject(!1);default:return!0}}function p(a){v=a,c.vm.questionsWithAnswers=v}function q(){x.$setViewValue(a.copy(c.vm.questionsWithAnswers))}function r(){return v[c.vm.currentSlide]}function s(b,d){if(b=a.isDefined(b)?b:c.vm.currentSlide,c.settings.viewMode!==i.REVIEW["enum"]){if(!s.lastTimeStamp)return void(s.lastTimeStamp=Date.now());var e=Date.now(),f=e-s.lastTimeStamp;s.lastTimeStamp=e;var g=c.vm.questionsWithAnswers[b];g.__questionStatus.timeSpent=(g.__questionStatus.timeSpent||0)+f,d||q()}}function t(){var a=0;c.vm.questionsWithAnswers.forEach(function(b){a+=b.__questionStatus.timeSpent||0});var b=c.settings.allowedTimeForExercise;return a>b}var u={onDone:a.noop,onQuestionAnswered:a.noop,viewMode:i.ANSWER_WITH_RESULT["enum"],onSlideChange:a.noop,initSlideDirection:j.ALL["enum"],initForceDoneBtnDisplay:null,initPagerDisplay:!0,allowedTimeForExercise:1/0};c.settings.allowedTimeForExercise=+c.settings.allowedTimeForExercise,isNaN(c.settings.allowedTimeForExercise)&&h.error("znkExerciseDrv: allowed time for exercise was not set!!!!"),c.settings=a.extend(u,c.settings);var v,w=n[0],x=n[1],y={},z=d.innerWidth<=567;w.addQuestionChangeResolver(o),c.vm.answeredCount=0,w.setCurrentIndex(c.settings.initSlideIndex||0),c.actions=c.actions||{},c.actions.setSlideIndex=function(a){w.isExerciseReady().then(function(){w.setCurrentIndex(a)})},c.actions.getCurrentIndex=function(){return w.getCurrentIndex()},c.actions.finishExercise=function(){s()},c.actions.setSlideDirection=function(b){w.isExerciseReady().then(function(){if(a.isDefined(b)){if(c.vm.slideDirection===b)return;var d=b===j.RIGHT["enum"],e=b===j.LEFT["enum"],h=b===j.ALL["enum"],i="direction",k=i+"-"+j.RIGHT.val;d||h?g.addClass(k):g.removeClass(k);var l=i+"-"+j.LEFT.val;e||h?g.addClass(l):g.removeClass(l),c.vm.slideDirection=b,c.$broadcast(f.SLIDE_DIRECTION_CHANGED,b)}})},c.actions.forceDoneBtnDisplay=function(a){w.isExerciseReady().then(function(){c.vm.btnSectionActions.forceDoneBtnDisplay(a)})},c.actions.pagerDisplay=function(a){w.isExerciseReady().then(function(){var b=!!a;b?g.addClass("pager-displayed"):g.removeClass("pager-displayed"),c.vm.showPager=!!a})},x.$render=function(){p(x.$viewValue)};var A={toolsToHide:c.settings.toolsToHide,wrapperCls:c.settings.toolBoxWrapperClass||""};A.events={onToolOpened:function(a){var d=r();switch(a.tool){case b.toolBoxTools.BLACKBOARD:A.actions.setToolValue(b.toolBoxTools.BLACKBOARD,d.__questionStatus.blackboardData||{}),
z&&(c.vm.hidePager=!0)}},onToolClosed:function(a){var d=r();switch(a.tool){case b.toolBoxTools.BLACKBOARD:d.__questionStatus.blackboardData=a.value,z&&(c.vm.hidePager=!1)}q()},onToolValueChanged:function(a){switch(a.tool){case b.toolBoxTools.BOOKMARK:c.vm.bookmarkCurrentQuestion()}q()}};var B=b.openExerciseToolBoxModal(A);y.formatter=function(b){b||(b=[]);var d={};b.forEach(function(b){b&&a.isDefined(b.questionId)&&(d[b.questionId]=b)});var e=c.questionsGetter()||[],f=e.map(function(b,c){var e=a.copy(b),f=d[e.id]||{};e.__questionStatus={index:c};for(var g in f)e.__questionStatus[g]=f[g];return e});return f},x.$formatters.push(y.formatter),y.parser=function(b){c.vm.answeredCount=0;var d=x.$modelValue||[];return b.forEach(function(b,e){if(!a.isUndefined(b.__questionStatus)){var f={questionId:b.id},g=["blackboardData","timeSpent","bookmark","userAnswer","isAnsweredCorrectly","audioEnded","afterAllowedTime"];g.forEach(function(c){var d=b.__questionStatus[c];a.isDefined(d)&&(f[c]=d)}),a.isDefined(f.userAnswer)&&c.vm.answeredCount++,d[e]=f}}),d},x.$parsers.push(y.parser),c.vm.questionAnswered=function(){if(c.settings.viewMode!==i.REVIEW["enum"]){var a=r(),b=a.__questionStatus.userAnswer;a.__questionStatus.isAnsweredCorrectly=l.isAnswerCorrect(a,b),s(void 0,!0);var d=t();a.__questionStatus.afterAllowedTime=d,q()}c.$broadcast(f.QUESTION_ANSWERED,r()),k(function(){c.settings.onQuestionAnswered(c.vm.currentSlide)})},c.vm.bookmarkCurrentQuestion=function(){var a=r();a.__questionStatus.bookmark=!a.__questionStatus.bookmark,c.$broadcast(f.BOOKMARK,a),q()},c.actions.setSlideDirection(c.settings.initSlideDirection),c.actions.forceDoneBtnDisplay(c.settings.initForceDoneBtnDisplay),c.actions.pagerDisplay(c.settings.initPagerDisplay),c.$watch("vm.currentSlide",function(d,e){if(!a.isUndefined(d)){var g=r();s(e),A.actions&&A.actions.setToolValue&&A.actions.setToolValue(b.toolBoxTools.BOOKMARK,!!g.__questionStatus.bookmark),k(function(){c.settings.onSlideChange(g,d),c.$broadcast(f.QUESTION_CHANGED,d,e,g)},0,!1)}}),c.$watch("vm.questionsWithAnswers.length",function(a,b){c.$broadcast(f.QUESTIONS_NUM_CHANGED,a,b)}),c.$on("$destroy",function(){B&&B.close()})}}}}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").controller("ZnkExerciseDrvCtrl",["$scope","$q","ZnkExerciseEvents","$log","$element",function(b,c,d,e,f){function g(c){var d=b.vm.questionsWithAnswers?b.vm.questionsWithAnswers[c]:{};return d&&d.__questionStatus&&a.isDefined(d.__questionStatus.userAnswer)}function h(b,d){var e=[];return m.forEach(function(f){var g=c.when(a.isFunction(f)?f(b,d):f);e.push(g)}),c.all(e)}var i=this,j=c.defer(),k=c.defer(),l=c.all([j.promise,k.promise]);l.then(function(){b.$broadcast(d.READY),b.settings.onExerciseReady&&b.settings.onExerciseReady()}),i.isExerciseReady=function(){return l},i.getViewMode=function(){return b.settings.viewMode},i.getSlideDirection=function(){return b.settings.slideDirection};var m=[];i.addQuestionChangeResolver=function(a){m.push(a)},i.removeQuestionChangeResolver=function(a){var b=[];m.forEach(function(c){c!==a&&b.push(c)}),m=b},i.getCurrentIndex=function(){return b.vm.currentSlide},i.setCurrentIndex=function(d){if(a.isDefined(d)){var f=i.getCurrentIndex();return h(d,f).then(function(){d=Math.max(0,d);var a=b.questionsGetter()||[];return d=Math.min(d,a.length-1),b.vm.currentSlide=d,b.vm.currentSlide})}return e.debug("ZnkExerciseDrv: setCurrentIndex was invoked with undefined newQuestionIndex parameter"),c.when(b.vm.currentSlide)},i.setCurrentIndexByOffset=function(a){var b=this.getCurrentIndex(),c=b+a;return this.setCurrentIndex(c)},i.notifyQuestionBuilderReady=function(){j.resolve()},i.notifyBtnSectionReady=function(){k.resolve()},i.isCurrentQuestionAnswered=function(){return g(b.vm.currentSlide)},i.isLastUnansweredQuestion=function(){for(var a=(b.vm.questionsWithAnswers||[]).length,c=0,d=0;a>d;d++)if(!g(d)&&(c++,2===c))return!1;return 1===c},i.getQuestions=function(){return j.promise.then(function(){return b.vm.questionsWithAnswers})},i.areAllQuestionsAnswered=function(){var a=i.answeredCount;return i.getQuestions().then(function(b){return a===b.length})},i.getElement=function(){return f}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("znkExercisePager",["$timeout","ZnkExerciseEvents","ZnkExerciseViewModeEnum",function(b,c,d){return{templateUrl:"components/znkExercise/core/template/znkExercisePagerDrv.html",restrict:"E",require:["ngModel","^znkExercise"],scope:{},link:{pre:function(e,f,g,h){function i(b,c){var d=a.element(o.querySelectorAll(".pager-item")[b]);c?d.addClass("bookmark"):d.removeClass("bookmark")}function j(b,c){var e=a.element(o.querySelectorAll(".pager-item")[b]);return a.isUndefined(c.__questionStatus.userAnswer)?void e.removeClass("neutral correct wrong"):n===d.ONLY_ANSWER["enum"]?void e.addClass("neutral"):void(c.__questionStatus.isAnsweredCorrectly?e.addClass("correct"):e.addClass("wrong"))}function k(){p=!0,b(function(){l.$render=function(){var c=+l.$viewValue;isNaN(c)||b(function(){var b,d=a.element(o.querySelectorAll(".pager-item.current"));for(b in d)d.eq(b).removeClass("current");var f=o.querySelectorAll(".pager-item"),g=a.element(f[c]);g.addClass("current");for(b in e.questions){var h=e.questions[b];i(b,h.__questionStatus.bookmark),j(b,h)}})},l.$render()},!1)}var l=h[0],m=h[1],n=m.getViewMode(),o=f[0];e.d={},e.d.tap=function(a){m.setCurrentIndex(a)},e.$on(c.BOOKMARK,function(a,b){i(b.__questionStatus.index,b.__questionStatus.bookmark)}),e.$on(c.QUESTION_ANSWERED,function(a,b){j(b.__questionStatus.index,b)});var p;e.$parent.$watch(g.questions,function(a){a&&(e.questions=a,p||k())})}}}}])}(angular),function(){angular.module("znk.infra.znkExercise").directive("blackboardDrv",["GoBackHardwareSrv",function(a){return{restric:"EA",scope:{drawingData:"=",actions:"&",close:"&"},replace:!0,templateUrl:"scripts/exercise/templates/blackboardDrv.html",link:function(b,c){function d(){b.close()}function e(){b.d.activeDrawMode=o.pen}function f(){b.d.activeDrawMode=o.eraser}function g(){s.clearRect(0,0,r.width,r.height),b.drawingData.dataUrl=null}function h(a){return a.toDataURL()}function i(a,b){var c=new Image;c.onload=function(){b.width=c.width,b.height=c.height,b.getContext("2d").drawImage(c,0,0)},c.src=a}function j(a){a.preventDefault(),a.stopPropagation(),p=a.targetTouches[0].pageX,q=a.targetTouches[0].pageY,m(p+1,q+1)}function k(a){a.preventDefault(),a.stopPropagation();var b=a.targetTouches[0].pageX,c=a.targetTouches[0].pageY;m(b,c),p=b,q=c}function l(a){a.preventDefault(),a.stopPropagation(),b.drawingData=b.drawingData||{},b.drawingData.dataUrl=h(r)}function m(a,c){s.beginPath(),b.d.activeDrawMode===o.pen?(s.globalCompositeOperation="source-over",s.strokeStyle="#FFFFFF",s.lineWidth=4,s.moveTo(p,q),s.lineTo(a,c),s.stroke()):b.d.activeDrawMode===o.eraser&&(s.globalCompositeOperation="destination-out",s.arc(p,q,16,0,2*Math.PI,!1),s.fill())}a.registerHandler(d,void 0,!0);var n=b.actions()||{};angular.extend(n,{activatePen:e,activateEraser:f,clear:g});var o={pen:1,eraser:2};b.d={drawModes:o,activeDrawMode:o.pen};var p,q,r=c.find("canvas")[0];r.width=c[0].offsetWidth,r.height=c[0].offsetHeight;var s=r.getContext("2d");b.drawingData.dataUrl&&i(b.drawingData.dataUrl,r),r.addEventListener("touchstart",j),r.addEventListener("touchmove",k),r.addEventListener("touchend",l),b.$on("$destroy",function(){r.removeEventListener("touchstart",j),r.removeEventListener("touchmove",k),r.removeEventListener("touchend",l)})}}}])}(),function(a){a.module("znk.infra.znkExercise").directive("calculator",["GoBackHardwareSrv",function(a){var b=math.cos,c=math.sin,d=math.tan;return{scope:{calcTop:"=",close:"&"},link:function(e){function f(){e.close()}a.registerHandler(f,void 0,!0),math.cos=function(a){return b(math.unit(a,e.trigunits))},math.sin=function(a){return c(math.unit(a,e.trigunits))},math.tan=function(a){return d(math.unit(a,e.trigunits))},e.onClickAns=function(){"ERR"!==e.result&&(e.expression=e.result)},e.onClickNum=function(a){e.expression+=String(a)},e.onClickAdd=function(){e.result&&"ERR"!==e.result&&(e.expression+=e.result),e.expression+=" + "},e.onClickSubtract=function(){e.result&&"ERR"!==e.result&&(e.expression+=e.result),e.expression+=" - "},e.onClickMultiply=function(){e.result&&"ERR"!==e.result&&(e.expression+=e.result),e.expression+=" * "},e.onClickDivide=function(){e.result&&"ERR"!==e.result&&(e.expression+=e.result),e.expression+=" / "},e.onClickClear=function(){e.expression="",e.result=0},e.onClickDot=function(){e.expression+="."},e.onClickPi=function(){e.expression+=" pi "},e.onClickE=function(){e.expression+=" e "},e.onClickRad=function(){e.trigunits="rad"},e.onClickDeg=function(){e.trigunits="deg"},e.onClickSin=function(){e.expression+=" sin(",e.result&&"ERR"!==e.result&&(e.expression+=e.result)},e.onClickCos=function(){e.expression+=" cos(",e.result&&"ERR"!==e.result&&(e.expression+=e.result)},e.onClickTan=function(){e.expression+=" tan(",e.result&&"ERR"!==e.result&&(e.expression+=e.result)},e.onClickSqr=function(){e.result&&"ERR"!==e.result&&(e.expression+=e.result),e.expression+=" ^2 "},e.onClickPowThree=function(){e.result&&"ERR"!==e.result&&(e.expression+=e.result),e.expression+=" ^3 "},e.onClickPow=function(){e.result&&"ERR"!==e.result&&(e.expression+=e.result),e.expression+=" ^ "},e.onClickSqrt=function(){e.expression+=" sqrt(",e.result&&"ERR"!==e.result&&(e.expression+=e.result)},e.onClickInv=function(){e.expression+=" inv(",e.result&&"ERR"!==e.result&&(e.expression+=e.result)},e.onClickAbs=function(){e.expression+=" abs(",e.result&&"ERR"!==e.result&&(e.expression+=e.result)},e.onClickFact=function(){e.result&&"ERR"!==e.result&&(e.expression+=e.result),e.expression+="! "},e.onClickLog=function(){e.expression+=" log(",e.result&&"ERR"!==e.result&&(e.expression+=e.result)},e.onClickLn=function(){e.expression+=" ln(",e.result&&"ERR"!==e.result&&(e.expression+=e.result)},e.onClickOpenParen=function(){e.expression+="(",e.result&&"ERR"!==e.result&&(e.expression+=e.result)},e.onClickCloseParen=function(){e.expression+=")"},e.onClickUndo=function(){e.expression=e.expression.trimRight(),e.expression=e.expression.substring(0,e.expression.length-1)},e.onClickEqual=function(){var a=e.expression.replace("log","log10").replace("ln","log");try{e.result=math.round(math.eval(a),5)}catch(b){try{a+=")",e.result=math.round(math.eval(a),5)}catch(b){e.result="ERR"}}e.expression=""},e.onClickMPlus=function(){e.mem+=e.result},e.onClickMc=function(){e.mem=0},e.onClickMR=function(){e.expression+=e.mem},e.hasMemory=function(){return e.mem>0};var g=function(){e.result=0,e.expression="",e.mem=0,e.trigunits="rad"};g()},templateUrl:"scripts/exercise/templates/calculator.html"}}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").controller("ZnkExerciseToolBoxModalCtrl",["$scope","ZnkExerciseDrvSrv","Settings",function(b,c,d){function e(a,b){var c={tool:a,value:b};d.events.onToolValueChanged&&d.events.onToolValueChanged(c)}d.actions=d.actions||{},d.events=d.events||{},d.events.onToolOpened=d.events.onToolOpened||a.noop,d.events.onToolOpened=d.events.onToolOpened||a.noop,b.d={blackboardTool:{actions:{},value:{}},bookmarkTool:{},showPagerTool:{},tools:c.toolBoxTools,toolsStatus:{},toolsToHide:d.toolsToHide},d.actions.setToolValue=function(a,c){switch(a){case b.d.tools.BOOKMARK:b.d.bookmarkTool.value=c;break;case b.d.tools.BLACKBOARD:b.d.blackboardTool.value=c}},b.d.openTool=function(a){var c={tool:a};d.events.onToolOpened(c),b.d.toolsStatus[a]=!0},b.d.closeTool=function(a){var c={tool:a};switch(a){case b.d.tools.BLACKBOARD:c.value=b.d.blackboardTool.value;break;case b.d.tools.BOOKMARK:c.value=b.d.bookmarkTool.value}d.events.onToolClosed(c),b.d.toolsStatus[a]=!1},b.d.reverseBookmarkValue=function(){b.d.bookmarkTool.value=!b.d.bookmarkTool.value,e(b.d.tools.BOOKMARK,b.d.bookmarkTool.value)},b.d.activateBlackboardPencil=function(){b.d[b.d.tools.BLACKBOARD]||b.d.openTool(b.d.tools.BLACKBOARD),b.d.blackboardTool.pencilActivated=!0,b.d.blackboardTool.actions.activatePen&&b.d.blackboardTool.actions.activatePen()},b.d.activateBlackboardEraser=function(){b.d.blackboardTool.pencilActivated=!1,b.d.blackboardTool.actions.activateEraser&&b.d.blackboardTool.actions.activateEraser()},b.d.reverseShowPagerValue=function(){b.d.showPagerTool.value=!b.d.showPagerTool.value,e(b.d.tools.SHOW_PAGER,b.d.showPagerTool.value)},b.d.onCalcClick=function(){b.d.toolsStatus.hasOwnProperty(b.d.tools.CALCULATOR)?b.d.closeTool(b.d.tools.CALCULATOR):b.d.openTool(b.d.tools.CALCULATOR)}}])}(angular),function(a){"use strict";var b={};b.tutorial={FINISH:"tutorial:finish"},b.drill={FINISH:"drill:finish"},b.practice={FINISH:"practice:finish"},b.game={FINISH:"game:finish"},b.section={FINISH:"section:finish"},b.daily={STATUS_CHANGED:"daily:status"},b.exam={COMPLETE:"exam:complete"},a.module("znk.infra.znkExercise").constant("exerciseEventsConst",b)}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").directive("templateByPlatform",["ZnkExerciseSrv","PlatformEnum","$log",function(a,b,c){return{templateUrl:function(d,e){var f,g=e.prefix||"",h=a.getPlatform();switch(h){case b.DESKTOP["enum"]:f=e.desktopTemp;break;case b.MOBILE["enum"]:f=e.mobileTemp}return f||c.error("templateByPlatform directive: template was not defined for platform"),g+"/"+f},restrict:"E"}}])}(angular),function(a){"use strict";var b={unanswered:0,correct:1,wrong:2};a.module("znk.infra.znkExercise").constant("exerciseAnswerStatusConst",b),a.module("znk.infra.znkExercise").factory("ExerciseAnswerStatusEnum",["EnumSrv",function(a){var c=new a.BaseEnum([["unanswered",b.unanswered,"unanswered"],["correct",b.correct,"correct"],["wrong",b.wrong,"wrong"]]);return c.convertSimpleAnswerToAnswerStatusEnum=function(a){switch(a){case!0:return c.correct["enum"];case!1:return c.wrong["enum"];default:return c.unanswered["enum"]}},c}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").factory("PlatformEnum",["EnumSrv",function(a){return new a.BaseEnum([["MOBILE",1,"mobile"],["DESKTOP",2,"desktop"]])}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").factory("ZnkExerciseSlideDirectionEnum",["EnumSrv",function(a){return new a.BaseEnum([["NONE",1,"none"],["ALL",2,"all"],["RIGHT",3,"right"],["LEFT",4,"left"]])}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").factory("ZnkExerciseViewModeEnum",["EnumSrv",function(a){return new a.BaseEnum([["ANSWER_WITH_RESULT",1,"answer with result"],["ONLY_ANSWER",2,"answer only"],["REVIEW",3,"review"],["MUST_ANSWER",4,"must answer"]])}])}(angular),function(a){"use strict";a.module("znk.infra.znkExercise").factory("ZnkExerciseUtilitySrv",["AnswerTypeEnum","$log",function(b,c){var d={};d.bindFunctions=function(a,b,c){c.forEach(function(c){a[c]=b[c].bind(b)})};var e;return d.isAnswerCorrect=function(a,c){var d,f;switch(a.answerTypeId){case b.SELECT_ANSWER["enum"]:f=""+c,d=""+a.correctAnswerId===f;break;case b.FREE_TEXT_ANSWER["enum"]:f=""+c,e=a.correctAnswerText.map(function(a){return""+a.content}),d=-1!==e.indexOf(f);break;case b.RATE_ANSWER["enum"]:f=""+c,e=a.correctAnswerText.map(function(a){return""+a.id}),d=-1!==e.indexOf(f)}return!!d},d.setQuestionsGroupData=function(b,d){var e={};a.forEach(d,function(a){e[a.id]=a}),a.forEach(b,function(a){e[a.groupDataId]||c.debug("Group data is missing for the following question id "+a.id),a.groupData=e[a.groupDataId]||{}})},d}])}(angular),function(a){"use strict";a.module("znk.infra.znkTimeline").directive("znkTimeline",["$window","$templateCache","TimelineSrv",function(b,c,d){var e={restrict:"A",scope:{timelineData:"=",timelineSettings:"="},link:function(e,f){function g(b){var c=k.width;if(i={lastLine:[],biggestScore:{score:0}},j=void 0,"multi"===k.type){var d=k.distance*(b.data.length+2);c=d<k.width?k.width:d}k.isMax&&(k.max=0,a.forEach(b.data,function(a){a.score>k.max&&(k.max=a.score)})),l.width=2*c,l.height=2*k.height,l.style.width=c+"px",l.style.height=k.height+"px",m.scale(2,2),k.lineWidth&&(m.lineWidth=k.lineWidth),a.isDefined(b.id)&&k.colors&&a.isArray(k.colors)&&(m.strokeStyle=k.colors[b.id],m.fillStyle=k.colors[b.id]),m.beginPath(),h({moveTo:{x:0,y:k.height-2},lineTo:{x:k.distance,y:k.height-2}},!0),a.forEach(b.data,function(a,c){var d=Math.abs(k.height-k.subPoint-(a.score-k.min)/(k.max-k.min)*(k.height-2*k.subPoint)),e=(c+2)*k.distance,f=c===b.data.length-1;h({moveTo:{x:j.lineTo.x,y:j.lineTo.y},lineTo:{x:e,y:d},exerciseType:a.exerciseType,exerciseId:a.exerciseId,score:a.score,iconKey:a.iconKey||!1},!1,f),a.score>i.biggestScore.score&&(i.biggestScore={score:a.score,lastLineTo:j.lineTo})}),k.numbers&&a.isObject(k.numbers)&&setTimeout(function(){m.font=k.numbers.font,m.fillStyle=k.numbers.fillStyle,m.fillText(k.min,15,k.height-10),m.fillText(parseInt(i.biggestScore.score),15,i.biggestScore.lastLineTo.y||k.subPoint)}),k.onFinish&&a.isFunction(k.onFinish)&&k.onFinish({data:i,ctx:m,canvasElem:l})}function h(d,e,f){var g=10,h=20;a.isDefined(k.isMobile)&&!k.isMobile&&(g=15,h=25);var l=h/2;if(j=d,i.lastLine.push(j),m.moveTo(d.moveTo.x,d.moveTo.y),m.lineTo(d.lineTo.x,d.lineTo.y),m.stroke(),i.summeryScore&&!n&&(i.summeryScore.next=d.lineTo,n=!0),k.isSummery?k.isSummery===d.exerciseId&&(i.summeryScore={score:d.score,lineTo:d.lineTo,prev:i.lastLine[i.lastLine.length-2]},g=1.5*g,h+=5,l=h/2):f&&(g=1.5*g,h+=5,l=h/2),!e){m.beginPath(),m.arc(d.lineTo.x,d.lineTo.y,g,0,2*Math.PI,!1),m.fill(),(f&&!k.isSummery||k.isSummery===d.exerciseId)&&(m.beginPath(),m.arc(d.lineTo.x,d.lineTo.y,g+4,0,2*Math.PI,!1),m.stroke());var o,p=new Image,q=d.lineTo.y-l,r=d.lineTo.x-l;if(d.iconKey){o=k.images[d.iconKey];var s=c.get(o),t=s?"data:image/svg+xml;base64,"+b.btoa(s):o;p.onload=function(){m.drawImage(p,r,q,h,h)},p.src=t}}}var i,j,k=a.extend({width:b.innerWidth,height:b.innerHeight,images:d.getImages()},e.timelineSettings||{}),l=f[0],m=l.getContext("2d"),n=!1;e.$watch("timelineData",function(b,c){a.isDefined(b)&&(b!==c?(m.clearRect(0,0,l.width,l.height),b.data.length&&g(b)):g(b))})}};return e}])}(angular),function(a){"use strict";a.module("znk.infra.znkTimeline").provider("TimelineSrv",["SvgIconSrvProvider",function(){var b;this.setImages=function(a){b=a},this.$get=["$log",function(c){return{getImages:function(){return a.isObject(b)||c.error("TimelineSrv getImages: obj is not an object! imgObj:",b),b}}}]}])}(angular),angular.module("znk.infra").run(["$templateCache",function(a){a.put("components/general/templates/timerDrv.html",'<div ng-switch="type" class="timer-drv">\n    <div ng-switch-when="1" class="timer-type1">\n        <svg-icon class="icon-wrapper" name="clock-icon"></svg-icon>\n        <div class="timer-view"></div>\n    </div>\n    <div ng-switch-when="2" class="timer-type2">\n        <div class="timer-display-wrapper">\n            <span class="timer-display"></span>\n        </div>\n        <div round-progress\n             current="ngModelCtrl.$viewValue"\n             max="config.max"\n             color="{{config.color}}"\n             bgcolor="{{config.bgcolor}}"\n             stroke="{{config.stroke}}"\n             radius="{{config.radius}}"\n             clockwise="config.clockwise">\n        </div>\n    </div>\n</div>\n'),a.put("components/znkExercise/answerTypes/templates/freeTextAnswerDrv.html",'<div class="free-text-answer-wrapper" ng-switch="showCorrectAnswer">\n\n    <div ng-switch-when="true" ng-class="userAnswerStatus">\n        <div class="answer-status">\n            <div class="user-answer">{{d.userAnswer}}</div>\n            <svg-icon class="correct-icon" name="correct"></svg-icon>\n            <svg-icon class="wrong-icon" name="wrong"></svg-icon>\n        </div>\n        <div class="correct-answer">Correct answer: <span>{{correctAnswer}}</span></div>\n    </div>\n\n    <div ng-switch-when="false">\n        <div class="instructions-title-wrapper">\n            <div class="instructions-title">Type your answer in the textboxes below.<svg-icon name="info"></svg-icon></div>\n            <div class="note-title">Note: answers cannot be longer than four characters (including decimal points and fractions signs)</div>\n        </div>\n        <div class="input-wrapper">\n            <input min="0" max="99" required ng-model="d.userAnswer">\n            <div class="arrow-wrapper" ng-click="clickHandler(d.userAnswer)">\n                <svg-icon name="arrow"></svg-icon>\n                <div class="svg-back"></div>\n            </div>\n        </div>\n    </div>\n\n</div>\n'),a.put("components/znkExercise/answerTypes/templates/rateAnswerDrv.html",'<div class="rate-answer-wrapper">\n\n    <div class="checkbox-items-wrapper" >\n\n        <div class="item-repeater" ng-repeat="item in d.itemsArray track by $index">\n            <svg-icon class="correct-icon" name="correct"></svg-icon>\n            <svg-icon class="wrong-icon" name="wrong"></svg-icon>\n            <div class="checkbox-item" ng-click="clickHandler($index)">\n                <div class="item-index">{{$index +  2}}</div>\n            </div>\n            <div class="correct-answer-line"></div>\n        </div>\n\n    </div>\n</div>\n'),a.put("components/znkExercise/answerTypes/templates/selectAnswerDrv.html",'<div ng-repeat="answer in ::d.answers track by answer.id" class="answer" ng-click="d.click(answer)">\n    <div class="content-wrapper">\n        <div class="answer-index-wrapper">\n            <span class="index-char">{{::d.getIndexChar($index)}}</span>\n        </div>\n        <markup content="answer.content" type="md" class="content"></markup>\n        <svg-icon class="correct-icon-drv" name="correct"></svg-icon>\n        <svg-icon class="wrong-icon-drv" name="wrong"></svg-icon>\n    </div>\n</div>\n'),a.put("components/znkExercise/core/template/btnSectionDesktopTemplate.html",'<div class="btn-container left-container ng-hide"\n     ng-show="!!vm.currentQuestionIndex && vm.slideRightAllowed">\n    <button ng-click="vm.prevQuestion()">\n        <svg-icon name="chevron"></svg-icon>\n    </button>\n</div>\n<div class="btn-container right-container ng-hide"\n     ng-show="vm.maxQuestionIndex !== vm.currentQuestionIndex && vm.slideLeftAllowed"\n     ng-class="{\'question-answered\': vm.isCurrentQuestionAnswered}">\n    <button ng-click="vm.nextQuestion()">\n        <svg-icon name="chevron"></svg-icon>\n    </button>\n</div>\n<div class="done-btn-wrap show-opacity-animate" ng-if="vm.showDoneButton">\n    <button tabindex="1" autofocus class="done-btn"\n            ng-click="onDone()">DONE\n    </button>\n</div>\n'),a.put("components/znkExercise/core/template/btnSectionMobileTemplate.html",'<div ng-class="{ \'next-disabled\' : settings.slideDirection === d.slideDirections.NONE ||  settings.slideDirection === d.slideDirections.RIGHT }">\n    <div class="bookmark-icon-container only-tablet"\n         ng-class="vm.questionsWithAnswers[vm.currentSlide].__questionStatus.bookmark ? \'bookmark-active-icon\' : \'bookmark-icon\'"\n         ng-click="vm.bookmarkCurrentQuestion()"\n         ng-hide="settings.viewMode === d.reviewModeId"></div>\n    <ng-switch\n            on="vm.currentSlide !== vm.questionsWithAnswers.length - 1 && vm.answeredCount !== vm.questionsWithAnswers.length"\n            ng-hide="settings.viewMode === d.reviewModeId"\n            class="ng-hide"\n            ng-click="d.next()">\n        <button ng-switch-when="true"\n                class="btn next">\n            <div class="only-tablet">\n                <span>NEXT</span>\n                <i class="question-arrow-right-icon"></i>\n            </div>\n        </button>\n        <button ng-switch-when="false"\n                class="btn finish">\n            <div>DONE</div>\n        </button>\n    </ng-switch>\n    <button class="btn sum ng-hide"\n            ng-click="settings.onSummary()"\n            ng-show="settings.viewMode === d.reviewModeId">\n        SUMMARY\n    </button>\n</div>\n'),a.put("components/znkExercise/core/template/questionSwiperDesktopTemplate.html",'<znk-swiper class="znk-carousel"\n            ng-model="vm.currSlideIndex"\n            actions="vm.swiperActions"\n            ng-change="vm.SlideChanged()"\n            disable-swipe="{{vm.isLocked}}">\n    <div class="swiper-slide"\n        ng-repeat="question in vm.questions ">\n        <question-builder question="question"\n                          rate-answer-formatter-parser\n                          ng-model="question.__questionStatus.userAnswer"\n                          ng-change="onQuestionAnswered(question)">\n        </question-builder>\n    </div>\n</znk-swiper>\n'),a.put("components/znkExercise/core/template/questionSwiperMobileTemplate.html",'<ion-slide-box znk-slide="settings.slideDirection" class="znk-carousel"\n               show-pager="false"\n               active-slide="vm.currentSlide">\n    <question-builder slide-repeat-drv="question in vm.questionsWithAnswers"\n                      question="question"\n                      ng-model="question.__questionStatus.userAnswer"\n                      ng-change="vm.questionAnswered(question)">\n    </question-builder>\n</ion-slide-box>\n'),a.put("components/znkExercise/core/template/znkExerciseDrv.html",'<div ng-transclude></div>\n<questions-carousel class="znk-carousel-container"\n                    questions="vm.questionsWithAnswers"\n                    disable-swipe="{{vm.slideDirection !== 2}}"\n                    ng-model="vm.currentSlide"\n                    on-question-answered="vm.questionAnswered()"\n                    slide-direction="{{vm.slideDirection}}">\n</questions-carousel>\n<div class="question-bottom-shadow"></div>\n<znk-exercise-btn-section class="btn-section"\n                          prev-question="vm.setCurrentIndexByOffset(-1)"\n                          next-question="vm.setCurrentIndexByOffset(1)"\n                          on-done="settings.onDone()"\n                          actions="vm.btnSectionActions">\n</znk-exercise-btn-section>\n<znk-exercise-pager class="ng-hide show-opacity-animate"\n                    ng-show="vm.showPager"\n                    questions="vm.questionsWithAnswers"\n                    ng-model="vm.currentSlide">\n</znk-exercise-pager>\n'),a.put("components/znkExercise/core/template/znkExercisePagerDrv.html",'<znk-scroll>\n    <div class="pager-items-wrapper">\n        <div class="pager-item noselect"\n             ng-repeat="question in questions track by question.id"\n             question-status="question.__questionStatus"\n             question="question"\n             ng-click="d.tap($index)">\n            <div class="question-bookmark-icon"></div>\n            <div class="question-status-indicator">\n                <div class="index">{{::$index + 1}}</div>\n            </div>\n        </div>\n    </div>\n</znk-scroll>\n'),a.put("components/znkExercise/core/template/znkSwiperTemplate.html",'<div class="swiper-container">\n    <!-- Additional required wrapper -->\n    <div class="swiper-wrapper" ng-transclude>\n        <!-- Slides -->\n    </div>\n</div>\n'),a.put("components/general/svg/clock-icon.svg",'<svg version="1.1" class="clock-icon-svg"\n     xmlns="http://www.w3.org/2000/svg"\n     x="0px"\n     y="0px"\n     viewBox="0 0 183 208.5">\n    <style>\n        .clock-icon-svg .st0 {\n            fill: none;\n            stroke: #757A83;\n            stroke-width: 10.5417;\n            stroke-miterlimit: 10;\n        }\n\n        .clock-icon-svg .st1 {\n            fill: none;\n            stroke: #757A83;\n            stroke-width: 12.3467;\n            stroke-linecap: round;\n            stroke-miterlimit: 10;\n        }\n\n        .clock-icon-svg .st2 {\n            fill: none;\n            stroke: #757A83;\n            stroke-width: 11.8313;\n            stroke-linecap: round;\n            stroke-miterlimit: 10;\n        }\n\n        .clock-icon-svg .st3 {\n            fill: none;\n            stroke: #757A83;\n            stroke-width: 22.9416;\n            stroke-miterlimit: 10;\n        }\n\n        .clock-icon-svg .st4 {\n            fill: none;\n            stroke: #757A83;\n            stroke-width: 14;\n            stroke-linecap: round;\n            stroke-miterlimit: 10;\n        }\n\n        .clock-icon-svg .st5 {\n            fill: none;\n            stroke: #757A83;\n            stroke-width: 18;\n            stroke-linejoin: round;\n            stroke-miterlimit: 10;\n        }\n\n\n    </style>\n    <g>\n        <circle class="st0" cx="91.5" cy="117" r="86.2"/>\n        <line class="st1" x1="92.1" y1="121.5" x2="92.1" y2="61"/>\n        <line class="st2" x1="92.1" y1="121.5" x2="131.4" y2="121.5"/>\n        <line class="st3" x1="78.2" y1="18.2" x2="104.9" y2="18.2"/>\n        <line class="st4" x1="61.4" y1="7" x2="121.7" y2="7"/>\n        <line class="st5" x1="156.1" y1="43" x2="171.3" y2="61"/>\n    </g>\n</svg>\n'),a.put("components/popUp/svg/exclamation-mark-icon.svg",'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n	 viewBox="-556.8 363.3 50.8 197.2" style="enable-background:new -556.8 363.3 50.8 197.2;" xml:space="preserve">\n<style type="text/css">\n	.exclamation-mark-icon .st0 {\n        fill: none;\n        enable-background: new;\n    }\n</style>\n<g>\n	<path d="M-505.9,401.6c-0.4,19.5-5.2,38.2-8.7,57.1c-2.8,15.5-4.7,31.2-6.7,46.8c-0.3,2.6-1.1,4-3.7,4.3c-1.5,0.2-2.9,0.6-4.4,0.7\n		c-9.2,0.7-9.6,0.4-10.7-8.7c-3.4-29.6-8-58.9-14.6-87.9c-2.3-10.1-3.2-20.4-0.5-30.7c3.7-14.1,17.2-22.3,31.5-19.3\n		c9.2,1.9,14.7,8.8,16.2,20.9C-506.7,390.3-506.4,396-505.9,401.6z"/>\n	<path d="M-528.9,525.7c10.9,0,16.8,5.3,16.9,15.2c0.1,11-9.3,19.7-21.4,19.6c-8.8,0-14.7-7-14.7-17.7\n		C-548.2,530.9-542.4,525.7-528.9,525.7z"/>\n</g>\n</svg>\n'),a.put("components/znkExercise/svg/arrow-icon.svg",'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="-468.2 482.4 96 89.8" class="arrow-icon-wrapper">\n    <style type="text/css">\n        .arrow-icon-wrapper .st0{fill:#109BAC;}\n        .arrow-icon-wrapper .st1{fill:none;stroke:#fff;stroke-width:5.1237;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;}\n    </style>\n    <path class="st0" d="M-417.2,572.2h-6.2c-24.7,0-44.9-20.2-44.9-44.9v0c0-24.7,20.2-44.9,44.9-44.9h6.2c24.7,0,44.9,20.2,44.9,44.9\n    v0C-372.2,552-392.5,572.2-417.2,572.2z"/>\n    <g>\n        <line class="st1" x1="-442.8" y1="527.3" x2="-401.4" y2="527.3"/>\n        <line class="st1" x1="-401.4" y1="527.3" x2="-414.3" y2="514.4"/>\n        <line class="st1" x1="-401.4" y1="527.3" x2="-414.3" y2="540.2"/>\n    </g>\n</svg>\n'),a.put("components/znkExercise/svg/chevron-icon.svg",'<svg x="0px" y="0px" viewBox="0 0 143.5 65.5">\n    <polyline class="st0" points="6,6 71.7,59.5 137.5,6 "/>\n</svg>\n'),a.put("components/znkExercise/svg/correct-icon.svg",'<svg version="1.1"\n     class="correct-icon-svg"\n     xmlns="http://www.w3.org/2000/svg"\n     xmlns:xlink="http://www.w3.org/1999/xlink"\n     x="0px"\n     y="0px"\n	 viewBox="0 0 188.5 129"\n     style="enable-background:new 0 0 188.5 129;"\n     xml:space="preserve">\n<style type="text/css">\n	.correct-icon-svg .st0 {\n        fill: none;\n        stroke: #231F20;\n        stroke-width: 15;\n        stroke-linecap: round;\n        stroke-linejoin: round;\n        stroke-miterlimit: 10;\n    }\n</style>\n<g>\n	<line class="st0" x1="7.5" y1="62" x2="67" y2="121.5"/>\n	<line class="st0" x1="67" y1="121.5" x2="181" y2="7.5"/>\n</g>\n</svg>\n'),a.put("components/znkExercise/svg/info-icon.svg",'<svg\n    version="1.1"\n    xmlns="http://www.w3.org/2000/svg"\n    x="0px"\n    y="0px"\n    viewBox="-497 499 28 28"\n    class="info-icon">\n<style type="text/css">\n	.info-icon .st0{fill:none;stroke:#0A9BAD; stroke-width:2;}\n	.info-icon .st2{fill:#0A9BAD;}\n</style>\n<g>\n	<circle class="st0" cx="-483" cy="513" r="13.5"/>\n	<g>\n		<path class="st2" d="M-485.9,509.2h3.9v8.1h3v1.2h-7.6v-1.2h3v-6.9h-2.4V509.2z M-483.5,505.6h1.5v1.9h-1.5V505.6z"/>\n	</g>\n</g>\n</svg>\n'),a.put("components/znkExercise/svg/wrong-icon.svg",'<svg version="1.1"\n     class="wrong-icon-svg"\n     xmlns="http://www.w3.org/2000/svg"\n     xmlns:xlink="http://www.w3.org/1999/xlink"\n     x="0px"\n     y="0px"\n	 viewBox="0 0 126.5 126.5"\n     style="enable-background:new 0 0 126.5 126.5;"\n     xml:space="preserve">\n<style type="text/css">\n	.wrong-icon-svg .st0 {\n        fill: none;\n        stroke: #231F20;\n        stroke-width: 15;\n        stroke-linecap: round;\n        stroke-linejoin: round;\n        stroke-miterlimit: 10;\n    }\n</style>\n<g>\n	<line class="st0" x1="119" y1="7.5" x2="7.5" y2="119"/>\n	<line class="st0" x1="7.5" y1="7.5" x2="119" y2="119"/>\n</g>\n</svg>\n'),
a.put("components/znkTimeline/svg/icons/timeline-diagnostic-test-icon.svg",'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n	 viewBox="-145 277 60 60" style="enable-background:new -145 277 60 60;" xml:space="preserve" class="timeline-diagnostic-test-icon" width="30px" height="30px">\n	 <style type="text/css">\n     	.timeline-diagnostic-test-icon .st0{fill:#fff;}\n     </style>\n<g id="kUxrE9.tif">\n	<g>\n		<path class="st0" id="XMLID_93_" d="M-140.1,287c0.6-1.1,1.7-1.7,2.9-1.4c1.3,0.3,2,1.1,2.3,2.3c1.1,4,2.1,8,3.2,12c2.4,9.3,4.9,18.5,7.3,27.8\n			c0.1,0.3,0.2,0.6,0.2,0.9c0.3,1.7-0.6,3-2.1,3.3c-1.4,0.3-2.8-0.5-3.3-2.1c-1-3.6-2-7.3-2.9-10.9c-2.5-9.5-5-19-7.6-28.6\n			C-140.1,290-140.8,288.3-140.1,287z"/>\n		<path class="st0" id="XMLID_92_" d="M-89.6,289.1c-1,6.8-2.9,13-10,16c-3.2,1.4-6.5,1.6-9.9,0.9c-2-0.4-4-0.7-6-0.6c-4.2,0.3-7.1,2.7-9,6.4\n			c-0.3,0.5-0.5,1.1-0.9,2c-0.3-1-0.5-1.7-0.8-2.5c-2-7-3.9-14.1-5.9-21.2c-0.3-1-0.1-1.7,0.5-2.4c4.5-6,11-7.4,17.5-3.6\n			c3.4,2,6.7,4.2,10.2,6.1c1.9,1,3.9,1.9,5.9,2.4c3.2,0.9,5.9,0,7.9-2.6C-90,289.7-89.8,289.4-89.6,289.1z"/>\n	</g>\n</g>\n</svg>\n'),a.put("components/znkTimeline/svg/icons/timeline-drills-icon.svg",'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n	 viewBox="-145 277 60 60" style="enable-background:new -145 277 60 60;" xml:space="preserve" class="timeline-drills-icon" width="30px" height="30px">\n<style type="text/css">\n    .timeline-drills-icon .all > * { fill: #fff; }\n	.timeline-drills-icon .st0{clip-path:url(#SVGID_2_);}\n	.timeline-drills-icon .st1{clip-path:url(#SVGID_4_);}\n</style>\n<g id="XMLID_93_" class="all">\n	<path id="XMLID_105_" d="M-105.3,308.4h-18.6c-0.6,0-1-0.4-1-1c0-0.6,0.4-1,1-1h18.6c0.6,0,1,0.4,1,1S-104.8,308.4-105.3,308.4z"/>\n	<g id="XMLID_100_">\n		<path id="XMLID_104_" d="M-128.2,317.9c-1.1,0-2-0.9-2-2v-17.8c0-1.1,0.9-2,2-2c1.1,0,2,0.9,2,2v17.8\n			C-126.2,317-127.1,317.9-128.2,317.9z"/>\n		<path id="XMLID_103_" d="M-132.7,313.7c-0.7,0-1.2-0.6-1.2-1.2v-10.8c0-0.7,0.6-1.2,1.2-1.2c0.7,0,1.2,0.6,1.2,1.2v10.8\n			C-131.5,313.1-132,313.7-132.7,313.7z"/>\n		<g id="XMLID_101_">\n			<g>\n				<g>\n					<g>\n						<defs>\n							<rect id="SVGID_1_" x="-140" y="305.6" width="4.3" height="4.3"/>\n						</defs>\n						<clipPath id="SVGID_2_">\n							<use xlink:href="#SVGID_1_"  style="overflow:visible;"/>\n						</clipPath>\n						<path id="XMLID_99_" class="st0" d="M-134,308.9h-1.5c-0.8,0-1.4-0.6-1.4-1.4c0-0.8,0.6-1.4,1.4-1.4h1.5\n							c0.8,0,1.4,0.6,1.4,1.4C-132.6,308.3-133.2,308.9-134,308.9z"/>\n					</g>\n				</g>\n			</g>\n		</g>\n	</g>\n	<g id="XMLID_94_">\n		<path id="XMLID_98_" d="M-101.3,317.9c-1.1,0-2-0.9-2-2v-17.8c0-1.1,0.9-2,2-2s2,0.9,2,2v17.8C-99.3,317-100.2,317.9-101.3,317.9z\n			"/>\n		<path id="XMLID_97_" d="M-96.8,313.7c-0.7,0-1.2-0.6-1.2-1.2v-10.8c0-0.7,0.6-1.2,1.2-1.2c0.7,0,1.2,0.6,1.2,1.2v10.8\n			C-95.5,313.1-96.1,313.7-96.8,313.7z"/>\n		<g id="XMLID_95_">\n			<g>\n				<g>\n					<g>\n						<defs>\n							<rect id="SVGID_3_" x="-94.3" y="305.6" width="4.3" height="4.3"/>\n						</defs>\n						<clipPath id="SVGID_4_">\n							<use xlink:href="#SVGID_3_"  style="overflow:visible;"/>\n						</clipPath>\n						<path id="XMLID_107_" class="st1" d="M-94,308.9h-1.5c-0.8,0-1.4-0.6-1.4-1.4c0-0.8,0.6-1.4,1.4-1.4h1.5\n							c0.8,0,1.4,0.6,1.4,1.4C-92.7,308.3-93.3,308.9-94,308.9z"/>\n					</g>\n				</g>\n			</g>\n		</g>\n	</g>\n</g>\n</svg>\n'),a.put("components/znkTimeline/svg/icons/timeline-mini-challenge-icon.svg",'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n	 viewBox="-105 277 60 60" style="enable-background:new -105 277 60 60;" xml:space="preserve" class="timeline-mini-challenge-icon" width="30px" height="30px">\n	 	 <style type="text/css">\n          	.timeline-mini-challenge-icon .st0{fill:#fff;}\n          </style>\n<g>\n	<path class="st0" d="M-75,332c-11.5,0-21-9.4-21-21c0-11.5,9.4-21,21-21s21,9.4,21,21S-63.5,332-75,332z M-75,292.7c-10.1,0-18.4,8.2-18.4,18.4\n		s8.2,18.4,18.4,18.4s18.4-8.2,18.4-18.4S-64.9,292.7-75,292.7z"/>\n	<circle class="st0" cx="-74.8" cy="312" r="2.3"/>\n	<path class="st0" d="M-74.1,308.1h-1c-0.2,0-0.4-0.1-0.4-0.2v-10.6c0-0.1,0.2-0.2,0.4-0.2h1c0.2,0,0.4,0.1,0.4,0.2v10.6\n		C-73.7,307.9-73.9,308.1-74.1,308.1z"/>\n	<path class="st0" d="M-71,310.8l-0.6-1c-0.1-0.2-0.1-0.4,0-0.5l4.4-2.6c0.1-0.1,0.4,0,0.5,0.2l0.6,1c0.1,0.2,0.1,0.4,0,0.5l-4.4,2.6\n		C-70.6,311.1-70.8,311-71,310.8z"/>\n	<path class="st0" d="M-76.9,285.8v1.8c0,1.2,0.9,2.1,2.1,2.1c1.2,0,2.1-0.9,2.1-2.1v-1.8H-76.9z"/>\n	<path class="st0" d="M-68.5,283.2c0,0.7-0.5,1.2-1.2,1.2h-9.7c-0.7,0-1.2-0.5-1.2-1.2l0,0c0-0.7,0.5-1.2,1.2-1.2h9.7\n		C-69,282-68.5,282.5-68.5,283.2L-68.5,283.2z"/>\n</g>\n</svg>\n'),a.put("components/znkTimeline/svg/icons/timeline-test-icon.svg",'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n	 viewBox="-111 277 60 60" style="enable-background:new -111 277 60 60;" xml:space="preserve" class="timeline-test-icon" width="30px" height="30px">\n<style type="text/css">\n	.timeline-test-icon .st0{fill:#fff;}\n</style>\n<g>\n	<path class="st0" d="M-62.9,332h-36.2c-1.5,0-2.8-1.2-2.8-2.8v-44.5c0-1.5,1.2-2.8,2.8-2.8h36.2c1.5,0,2.8,1.2,2.8,2.8v44.5\n		C-60.1,330.8-61.4,332-62.9,332z M-99.1,283.6c-0.6,0-1.2,0.5-1.2,1.2v44.5c0,0.6,0.5,1.2,1.2,1.2h36.2c0.6,0,1.2-0.5,1.2-1.2\n		v-44.5c0-0.6-0.5-1.2-1.2-1.2H-99.1L-99.1,283.6z"/>\n	<g id="XMLID_312_">\n		<circle id="XMLID_199_" class="st0" cx="-95" cy="287.6" r="1"/>\n		<circle id="XMLID_198_" class="st0" cx="-92.5" cy="287.6" r="1"/>\n		<circle id="XMLID_197_" class="st0" cx="-89.9" cy="287.6" r="1"/>\n		<circle id="XMLID_196_" class="st0" cx="-95" cy="290.1" r="1"/>\n		<circle id="XMLID_195_" class="st0" cx="-92.5" cy="290.1" r="1"/>\n		<circle id="XMLID_194_" class="st0" cx="-90" cy="290.1" r="1"/>\n		<circle id="XMLID_193_" class="st0" cx="-95" cy="292.9" r="1"/>\n		<circle id="XMLID_192_" class="st0" cx="-92.5" cy="292.9" r="1"/>\n		<circle id="XMLID_191_" class="st0" cx="-89.9" cy="292.9" r="1"/>\n	</g>\n	<g id="XMLID_302_">\n		<circle id="XMLID_190_" class="st0" cx="-83.6" cy="287.6" r="1"/>\n		<circle id="XMLID_189_" class="st0" cx="-81.1" cy="287.6" r="1"/>\n		<circle id="XMLID_188_" class="st0" cx="-78.6" cy="287.6" r="1"/>\n		<circle id="XMLID_187_" class="st0" cx="-83.7" cy="290.1" r="1"/>\n		<circle id="XMLID_186_" class="st0" cx="-81.1" cy="290.1" r="1"/>\n		<circle id="XMLID_185_" class="st0" cx="-78.6" cy="290.1" r="1"/>\n		<circle id="XMLID_184_" class="st0" cx="-83.6" cy="292.9" r="1"/>\n		<circle id="XMLID_183_" class="st0" cx="-81.1" cy="292.9" r="1"/>\n		<circle id="XMLID_182_" class="st0" cx="-78.6" cy="292.9" r="1"/>\n	</g>\n	<g id="XMLID_292_">\n		<circle id="XMLID_181_" class="st0" cx="-72.3" cy="287.6" r="1"/>\n		<circle id="XMLID_180_" class="st0" cx="-69.8" cy="287.6" r="1"/>\n		<circle id="XMLID_179_" class="st0" cx="-67.2" cy="287.6" r="1"/>\n		<circle id="XMLID_178_" class="st0" cx="-72.3" cy="290.1" r="1"/>\n		<circle id="XMLID_177_" class="st0" cx="-69.8" cy="290.1" r="1"/>\n		<circle id="XMLID_176_" class="st0" cx="-67.2" cy="290.1" r="1"/>\n		<circle id="XMLID_175_" class="st0" cx="-72.3" cy="292.9" r="1"/>\n		<circle id="XMLID_174_" class="st0" cx="-69.8" cy="292.9" r="1"/>\n		<circle id="XMLID_173_" class="st0" cx="-67.2" cy="292.9" r="1"/>\n	</g>\n	<g id="XMLID_282_">\n		<circle id="XMLID_172_" class="st0" cx="-94.9" cy="298.5" r="1"/>\n		<circle id="XMLID_171_" class="st0" cx="-92.3" cy="298.5" r="1"/>\n		<circle id="XMLID_170_" class="st0" cx="-89.8" cy="298.5" r="1"/>\n		<circle id="XMLID_169_" class="st0" cx="-94.9" cy="301" r="1"/>\n		<circle id="XMLID_168_" class="st0" cx="-92.4" cy="301" r="1"/>\n		<circle id="XMLID_167_" class="st0" cx="-89.8" cy="301" r="1"/>\n		<circle id="XMLID_166_" class="st0" cx="-94.9" cy="303.8" r="1"/>\n		<circle id="XMLID_165_" class="st0" cx="-92.3" cy="303.8" r="1"/>\n		<circle id="XMLID_164_" class="st0" cx="-89.8" cy="303.8" r="1"/>\n	</g>\n	<g id="XMLID_272_">\n		<circle id="XMLID_163_" class="st0" cx="-83.5" cy="298.5" r="1"/>\n		<circle id="XMLID_162_" class="st0" cx="-81" cy="298.5" r="1"/>\n		<circle id="XMLID_161_" class="st0" cx="-78.4" cy="298.5" r="1"/>\n		<circle id="XMLID_160_" class="st0" cx="-83.5" cy="301" r="1"/>\n		<circle id="XMLID_159_" class="st0" cx="-81" cy="301" r="1"/>\n		<circle id="XMLID_158_" class="st0" cx="-78.5" cy="301" r="1"/>\n		<circle id="XMLID_157_" class="st0" cx="-83.5" cy="303.8" r="1"/>\n		<circle id="XMLID_156_" class="st0" cx="-81" cy="303.8" r="1"/>\n		<circle id="XMLID_155_" class="st0" cx="-78.4" cy="303.8" r="1"/>\n	</g>\n	<g id="XMLID_262_">\n		<circle id="XMLID_154_" class="st0" cx="-72.1" cy="298.5" r="1"/>\n		<circle id="XMLID_153_" class="st0" cx="-69.6" cy="298.5" r="1"/>\n		<circle id="XMLID_152_" class="st0" cx="-67.1" cy="298.5" r="1"/>\n		<circle id="XMLID_151_" class="st0" cx="-72.2" cy="301" r="1"/>\n		<circle id="XMLID_150_" class="st0" cx="-69.6" cy="301" r="1"/>\n		<circle id="XMLID_149_" class="st0" cx="-67.1" cy="301" r="1"/>\n		<circle id="XMLID_148_" class="st0" cx="-72.1" cy="303.8" r="1"/>\n		<circle id="XMLID_147_" class="st0" cx="-69.6" cy="303.8" r="1"/>\n		<circle id="XMLID_146_" class="st0" cx="-67.1" cy="303.8" r="1"/>\n	</g>\n	<g id="XMLID_252_">\n		<circle id="XMLID_145_" class="st0" cx="-94.7" cy="309.2" r="1"/>\n		<circle id="XMLID_144_" class="st0" cx="-92.2" cy="309.2" r="1"/>\n		<circle id="XMLID_143_" class="st0" cx="-89.7" cy="309.2" r="1"/>\n		<circle id="XMLID_142_" class="st0" cx="-94.8" cy="311.7" r="1"/>\n		<circle id="XMLID_141_" class="st0" cx="-92.3" cy="311.7" r="1"/>\n		<circle id="XMLID_140_" class="st0" cx="-89.8" cy="311.7" r="1"/>\n		<circle id="XMLID_139_" class="st0" cx="-94.7" cy="314.4" r="1"/>\n		<circle id="XMLID_138_" class="st0" cx="-92.2" cy="314.4" r="1"/>\n		<circle id="XMLID_137_" class="st0" cx="-89.7" cy="314.4" r="1"/>\n	</g>\n	<g id="XMLID_242_">\n		<circle id="XMLID_136_" class="st0" cx="-83.4" cy="309.2" r="1"/>\n		<circle id="XMLID_135_" class="st0" cx="-80.9" cy="309.2" r="1"/>\n		<circle id="XMLID_134_" class="st0" cx="-78.3" cy="309.2" r="1"/>\n		<circle id="XMLID_133_" class="st0" cx="-83.4" cy="311.7" r="1"/>\n		<circle id="XMLID_132_" class="st0" cx="-80.9" cy="311.7" r="1"/>\n		<circle id="XMLID_131_" class="st0" cx="-78.4" cy="311.7" r="1"/>\n		<circle id="XMLID_130_" class="st0" cx="-83.4" cy="314.4" r="1"/>\n		<circle id="XMLID_129_" class="st0" cx="-80.9" cy="314.4" r="1"/>\n		<circle id="XMLID_128_" class="st0" cx="-78.3" cy="314.4" r="1"/>\n	</g>\n	<g id="XMLID_232_">\n		<circle id="XMLID_127_" class="st0" cx="-72" cy="309.2" r="1"/>\n		<circle id="XMLID_126_" class="st0" cx="-69.5" cy="309.2" r="1"/>\n		<circle id="XMLID_125_" class="st0" cx="-67" cy="309.2" r="1"/>\n		<circle id="XMLID_124_" class="st0" cx="-72" cy="311.7" r="1"/>\n		<circle id="XMLID_123_" class="st0" cx="-69.6" cy="311.7" r="1"/>\n		<circle id="XMLID_122_" class="st0" cx="-67" cy="311.7" r="1"/>\n		<circle id="XMLID_121_" class="st0" cx="-72" cy="314.4" r="1"/>\n		<circle id="XMLID_120_" class="st0" cx="-69.5" cy="314.4" r="1"/>\n		<circle id="XMLID_119_" class="st0" cx="-67" cy="314.4" r="1"/>\n	</g>\n	<g id="XMLID_222_">\n		<circle id="XMLID_118_" class="st0" cx="-94.5" cy="319.8" r="1"/>\n		<circle id="XMLID_117_" class="st0" cx="-91.9" cy="319.8" r="1"/>\n		<circle id="XMLID_116_" class="st0" cx="-89.4" cy="319.8" r="1"/>\n		<circle id="XMLID_115_" class="st0" cx="-94.5" cy="322.3" r="1"/>\n		<circle id="XMLID_114_" class="st0" cx="-92" cy="322.3" r="1"/>\n		<circle id="XMLID_113_" class="st0" cx="-89.5" cy="322.3" r="1"/>\n		<circle id="XMLID_112_" class="st0" cx="-94.5" cy="325.1" r="1"/>\n		<circle id="XMLID_111_" class="st0" cx="-91.9" cy="325.1" r="1"/>\n		<circle id="XMLID_110_" class="st0" cx="-89.4" cy="325.1" r="1"/>\n	</g>\n	<g id="XMLID_212_">\n		<circle id="XMLID_109_" class="st0" cx="-83.1" cy="319.8" r="1"/>\n		<circle id="XMLID_108_" class="st0" cx="-80.6" cy="319.8" r="1"/>\n		<circle id="XMLID_107_" class="st0" cx="-78.1" cy="319.8" r="1"/>\n		<circle id="XMLID_106_" class="st0" cx="-83.1" cy="322.3" r="1"/>\n		<circle id="XMLID_105_" class="st0" cx="-80.6" cy="322.3" r="1"/>\n		<circle id="XMLID_104_" class="st0" cx="-78.1" cy="322.3" r="1"/>\n		<circle id="XMLID_103_" class="st0" cx="-83.1" cy="325.1" r="1"/>\n		<circle id="XMLID_102_" class="st0" cx="-80.6" cy="325.1" r="1"/>\n		<circle id="XMLID_101_" class="st0" cx="-78.1" cy="325.1" r="1"/>\n	</g>\n	<g id="XMLID_202_">\n		<circle id="XMLID_100_" class="st0" cx="-71.7" cy="319.8" r="1"/>\n		<circle id="XMLID_99_" class="st0" cx="-69.2" cy="319.8" r="1"/>\n		<circle id="XMLID_98_" class="st0" cx="-66.7" cy="319.8" r="1"/>\n		<circle id="XMLID_97_" class="st0" cx="-71.8" cy="322.3" r="1"/>\n		<circle id="XMLID_96_" class="st0" cx="-69.3" cy="322.3" r="1"/>\n		<circle id="XMLID_95_" class="st0" cx="-66.8" cy="322.3" r="1"/>\n		<circle id="XMLID_94_" class="st0" cx="-71.7" cy="325.1" r="1"/>\n		<circle id="XMLID_93_" class="st0" cx="-69.2" cy="325.1" r="1"/>\n		<circle id="XMLID_92_" class="st0" cx="-66.7" cy="325.1" r="1"/>\n	</g>\n</g>\n</svg>\n'),a.put("components/znkTimeline/svg/icons/timeline-tips-tricks-icon.svg",'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n	 viewBox="-145 277 60 60" style="enable-background:new -145 277 60 60;" xml:space="preserve" class="timeline-tips-tricks-icon" width="30px" height="30px">\n<style type="text/css">\n	.timeline-tips-tricks-icon .st0{fill:#fff;}\n</style>\n<g id="XMLID_203_">\n	<path id="XMLID_209_" class="st0" d="M-115.2,285.5"/>\n	<path class="st0" id="XMLID_207_" d="M-123.6,319c-0.1,0-0.2,0-0.4,0c-0.8-0.2-1.3-1-1.1-1.8c0,0,0.9-4.1-1.7-7.4c-2.2-2.8-4.7-6.6-4.7-11.4\n		c0-9,7.3-16.4,16.4-16.4s16.4,7.3,16.4,16.4c0,4.8-2.5,8.6-4.7,11.4c-2.6,3.3-1.7,7.4-1.7,7.4c0.2,0.8-0.3,1.6-1.1,1.8\n		c-0.8,0.2-1.6-0.3-1.8-1.1c0-0.2-1.2-5.5,2.2-9.9c2-2.6,4-5.7,4-9.6c0-7.4-6-13.4-13.4-13.4c-7.4,0-13.4,6-13.4,13.4\n		c0,3.9,2,7,4,9.6c3.5,4.5,2.3,9.7,2.2,9.9C-122.3,318.6-122.9,319-123.6,319z"/>\n	<path class="st0" id="XMLID_206_" d="M-107.5,322.4h-15.1c-0.5,0-1-0.5-1-1c0-0.5,0.5-1,1-1h15.1c0.5,0,1,0.5,1,1\n		C-106.5,322-106.9,322.4-107.5,322.4z"/>\n	<path class="st0" id="XMLID_205_" d="M-107,325.4H-123c-0.5,0-1-0.5-1-1s0.5-1,1-1h16.1c0.5,0,1,0.5,1,1C-106,325-106.4,325.4-107,325.4z"/>\n	<path class="st0" id="XMLID_210_" d="M-109,328.5h-12.5c-0.5,0-1-0.5-1-1c0-0.5,0.5-1,1-1h12.5c0.5,0,1,0.5,1,1C-108,328-108.4,328.5-109,328.5z"/>\n	<path class="st0" id="XMLID_204_" d="M-111.1,329.7c-0.3,1.6-1.8,2.3-4.1,2.3s-3.6-0.8-4.1-2.3"/>\n</g>\n</svg>\n')}]);