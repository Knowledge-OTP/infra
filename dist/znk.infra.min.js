!function(a){"use strict";a.module("znk.infra",["znk.infra.pngSequence","znk.infra.enum","znk.infra.svgIcon","znk.infra.general","znk.infra.scroll","znk.infra.content"])}(angular),function(a){"use strict";a.module("znk.infra.content",[])}(angular),function(a){"use strict";a.module("znk.infra.enum",[])}(angular),function(a){"use strict";a.module("znk.infra.general",["znk.infra.enum"])}(angular),function(a){"use strict";a.module("znk.infra.pngSequence",[])}(angular),function(a){"use strict";a.module("znk.infra.scroll",[])}(angular),function(a){"use strict";a.module("znk.infra.svgIcon",[])}(angular),function(a){function b(){var b;this.setContent=function(a){b=a},this.$get=["$q","$injector",function(c,d){function e(){var a;return function(){return{get:function(){return a?c.when(a):f().then(function(b){return a=b,a.updatePublication(function(b){b.key()!==a.key&&(a.latestRevisions=b.val(),a.key=b.key())}),b})},set:function(b,d){return a.revisionManifest[b]=d,c.when({rev:d.rev,status:"update"})}}}}function f(){return g||(g=d.invoke(b)),g}var g,h=e(),i={};return i.getRev=function(b,d){if(!d||!d.revisionManifest||!d.latestRevisions)return c.when({error:"No Data Found! ",data:d});var e,f=d.revisionManifest[b],g=d.latestRevisions[b];return a.isUndefined(g)?c.when({error:"Not Found",data:d}):(e=f?f.rev<g.rev?{rev:f.rev,status:"old"}:f.rev===g.rev?{rev:g.rev,status:"same"}:{error:"failed to get revision!",data:d}:{rev:g.rev,status:"new"},c.when(e))},i.setRev=function(a,b){return h().set(a,{rev:b})},i.getContent=function(a){if(!a||!a.exerciseId||!a.exerciseType)return c.when({error:"Error: getContent require exerciseId and exerciseType!"});var b=a.exerciseType+a.exerciseId;return h().get().then(function(a){return i.getRev(b,a).then(function(d){if(d.error)return c.when(d);if(!a.contentRoot)return c.when({error:"Error: getContent require contentRoot to be defined in config phase!"});if(!a.userRoot)return c.when({error:"Error: getContent require userRoot to be defined in config phase!"});var e=a.contentRoot+b+"-rev-"+d.rev,f=a.create(e);return"new"===d.status&&i.setRev(b,d.rev).then(function(){var c=a.userRoot+"/revisionManifest/"+b,e=a.create(c);e.set({rev:d.rev})}),f.get()})})},i}]}a.module("znk.infra.content").provider("ContentSrv",b)}(angular),function(a){"use strict";var b={NEW:0,ACTIVE:1,COMPLETED:2,COMING_SOON:3};a.module("znk.infra.enum").constant("exerciseStatusConst",b),a.module("znk.infra.enum").factory("ExerciseStatusEnum",["EnumSrv",function(a){return new a.BaseEnum([["NEW",b.NEW,"new"],["ACTIVE",b.ACTIVE,"active"],["COMPLETED",b.COMPLETED,"completed"],["COMING_SOON",b.COMING_SOON,"coming soon"]])}])}(angular),function(a){"use strict";var b={MATH:0,READING:1,WRITING:2,LISTENING:3,SPEAKING:4,ENGLISH:5,SCIENCE:6};a.module("znk.infra.enum").constant("SubjectEnumConst",b),a.module("znk.infra.enum").factory("SubjectEnum",["EnumSrv",function(a){var c=new a.BaseEnum([["MATH",b.MATH,"math"],["READING",b.READING,"reading"],["WRITING",b.WRITING,"writing"],["LISTENING",b.LISTENING,"listening"],["SPEAKING",b.SPEAKING,"speaking"],["ENGLISH",b.ENGLISH,"english"],["SCIENCE",b.SCIENCE,"science"]]);return c}])}(angular),function(a){a.module("znk.infra.enum").factory("EnumSrv",[function(){function b(a){var b=0,c=1,d=2,e=this;a.forEach(function(a){e[a[b]]={"enum":a[c],val:a[d]}})}var c={};return c.BaseEnum=b,b.prototype.getEnumMap=function(){var a=this,b={},c=Object.keys(a);for(var d in c){var e=c[d],f=a[e];b[f["enum"]]=f.val}return b},b.prototype.getEnumArr=function(){var b=this,c=[];for(var d in b){var e=b[d];a.isObject(e)&&c.push(e)}return c},c.flashcardStatus=new b([["keep",0,"Keep"],["remove",1,"Remove"]]),c}])}(angular),function(a){"use strict";a.module("znk.infra.general").directive("subjectIdToClassDrv",["SubjectEnum",function(b){return{priority:1e3,link:{pre:function(c,d,e){var f=c.$watch(e.subjectIdToClassDrv,function(c){if(!a.isUndefined(c)){f();var g;for(var h in b)if(b[h]["enum"]===c){g=b[h].val,e.classSuffix&&(g+=e.classSuffix);break}d.addClass(g)}})}}}}])}(angular),function(a){"use strict";a.module("znk.infra.pngSequence").directive("pngSequence",["$timeout","ExpansionSrcSrv","$window",function(b,c,d){return{restrict:"E",scope:{onEnded:"&",loop:"&",speed:"&",autoPlay:"&",actions:"="},link:function(e,f,g){function h(){var a,b=+g.startIndex,d=+g.endIndex;n=d-b;for(var e=b;d>e;e++){a=100>e||10>e?10>e?"00"+e:"0"+e:e;var h="<div  style=\"background-image: url('"+c.getExpansionSrc(g.imgData+a+".png")+"'); background-size: cover; will-change: opacity; opacity:0; position: absolute; top:0; left:0;\"></div>";f.append(h)}}function i(){f.empty()}function j(){this.index=0,this.imagesDomElem=f[0].children,this.lastTimestamp=!1}function k(c){this.index!==n-1||e.loop()?this.lastTimestamp&&c-this.lastTimestamp<40?o=d.requestAnimationFrame(k.bind(this)):(this.imagesDomElem[this.index].style.opacity=0,this.index=(this.index+1)%n,this.imagesDomElem[this.index].style.opacity=1,this.lastTimestamp=c,o=d.requestAnimationFrame(k.bind(this))):b(function(){var b=f.children();a.element(b[b.length-1]).css("display","none"),e.onEnded()})}function l(){if(i(),g.imgData&&a.isDefined(g.startIndex)&&g.endIndex&&(h(),e.autoPlay())){var b=new j;o=d.requestAnimationFrame(k.bind(b))}}function m(){return g.imgData+"_"+g.startIndex+"_"+g.endIndex+"_"+g.rotate}var n,o;e.$watch(m,l),e.actions=e.actions||{},e.actions.play=function(){b(function(){var a=new j;o=d.requestAnimationFrame(k.bind(a))},0,!1)},e.actions.reset=i,e.$on("$destroy",function(){d.cancelAnimationFrame(o)})}}}])}(angular),function(a){"use strict";a.module("znk.infra.scroll").directive("znkScroll",["$log","$window","$timeout","$interpolate",function(b,c,d,e){function f(c,d,e,f,h){var i=a.isArray(c)?c[0]:c,j=d;if(e){var k,l=i.style.transform,m=l.match(/translateX\((.*)px\)/);!a.isArray(m)||m.length<2?(b.debug("failed to math transform value"),k=0):k=+m[1],j+=k}f=a.isUndefined(f)?-(1/0):f,h=a.isUndefined(h)?1/0:h,j=Math.max(j,f),j=Math.min(j,h);var n="translateX("+j+"px)";g(i,"transform",n)}function g(b,c,d){var e=a.isArray(b)?b[0]:b;null===d?e.style[c]="":e.style[c]=d}function h(b){var d=a.isArray(b)?b[0]:b,e=c.getComputedStyle(d),f=+e.marginRight.replace("px",""),g=+e.marginLeft.replace("px","");return d.offsetWidth+f+g}return{restrict:"E",compile:function(c){function i(a){b.debug("mouse move",a.pageX);var c=a.pageX-n.x;n.x=a.pageX,n.y=a.pageY,l(c,o,p)}function j(a){b.debug("mouse up",a.pageX),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",j),o=null,p=null,n=null}function k(a){b.debug("mouse down",a.pageX),o=q.offsetWidth,p=h(q.children[0]),n={x:a.pageX,y:a.pageY},document.addEventListener("mousemove",i),document.addEventListener("mouseup",j)}function l(a,b,c){var d=Math.min(b-c,0),e=0;r.style.transform||f(r,0,!1,!1,d,e),f(r,a,!0,d,e)}function m(a){var b=q.offsetWidth,c=h(r),d=Math.min(b-c,0),e=0;f(r,a,!1,d,e)}var n,o,p,q=c[0],r=q.children[0];return q.addEventListener("mousedown",k),{pre:function(c,j,n){function o(a){b.debug("mouse wheel event",a),l(-a.deltaY,t,u)}function p(){b.debug("mouse enter"),t=q.offsetWidth,u=h(q.children[0]),q.addEventListener("mousewheel",o)}function r(){b.debug("mouse leave"),q.removeEventListener("mousewheel",o)}var s=q.children[0];f(s,0);var t,u,v="false"!==e(n.scrollOnMouseWheel||"")(c);if(v&&(q.addEventListener("mouseenter",p),q.addEventListener("mouseleave",r)),n.actions){a.isUndefined(c.$eval(n.actions))&&c.$eval(n.actions+"={}");var w=c.$eval(n.actions);w.animate=function(a,b,c){if(b&&c){var e="transform "+b+"ms "+c;g(s,"transition",e)}m(a),d(function(){g(s,"transition",null)},b,!1)}}c.$on("$destroy",function(){document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",r),q.removeEventListener("mousedown",k),q.removeEventListener("mouseenter",p),q.removeEventListener("mouseleave",r),q.removeEventListener("mousewheel",o)})}}}}}])}(angular),function(a){"use strict";a.module("znk.infra.svgIcon").directive("svgIcon",["$log","SvgIconSrv",function(a,b){return{scope:{name:"@"},link:{pre:function(c,d){var e=c.name;return e?void b.getSvgByName(e).then(function(a){d.append(a)}):void a.error("svgIcon directive: name attribute was not set")}}}}])}(angular),function(a){"use strict";a.module("znk.infra.svgIcon").provider("SvgIconSrv",[function(){var b={};this.setConfig=function(c){a.extend(b,c)};var c;this.registerSvgSources=function(a){c=a};var d={};this.$get=["$templateCache","$q","$http",function(a,b,e){var f={};return f.getSvgByName=function(f){var g=c[f];if(d[g])return d[g];var h=a.get(g);if(h)return b.when(h);var i=e.get(g).then(function(b){return a.put(g,b.data),delete d[g],b.data});return d[g]=i,i},f}]}])}(angular);